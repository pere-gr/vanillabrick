{
  "version": 3,
  "sources": ["../src/brick/brick.js", "../src/controllers/extensionsRegistry.js", "../src/controllers/runtimeController.js", "../src/controllers/statusController.js", "../src/utils/options.js", "../src/controllers/optionsController.js", "../src/controllers/eventsController.js", "../src/controllers/extensionsController.js", "../src/startup/services.js", "../src/startup/bootstrap.js", "../src/extensions/html-css.js", "../src/extensions/html-events.js", "../src/extensions/html-render.js", "../src/extensions/html.js", "../src/extensions/store.js", "../src/extensions/wire-client.js", "../src/extensions/wire-service.js", "../src/components/form-items.js", "../src/components/form-record.js", "../src/components/form.js", "../src/components/status-bar.js", "../src/components/table-columns.js", "../src/components/table-rows-focused.js", "../src/components/table-rows.js", "../src/components/table.js", "../src/services/wire.js", "../src/_manifest.js", "../src/index.js"],
  "sourcesContent": ["/**\r\n * Brick constructor.\r\n * @constructor\r\n * @param {Object} options\r\n */\r\nexport default function Brick(options) {\r\n  const opts = options && typeof options === 'object' ? Object.assign({}, options) : {};\r\n  opts.id = opts.id || this._nextId();\r\n  opts.host = (opts.host || 'brick').toLowerCase();\r\n  opts.kind = (opts.kind || 'brick').toLowerCase();\r\n  Object.defineProperty(this, 'id', {\r\n    value: opts.id,\r\n    writable: false,\r\n    configurable: false,\r\n    enumerable: true\r\n  });\r\n  Object.defineProperty(this, 'host', {\r\n    value: opts.host,\r\n    writable: false,\r\n    configurable: false,\r\n    enumerable: true\r\n  });\r\n  Object.defineProperty(this, 'kind', {\r\n    value: opts.kind,\r\n    writable: false,\r\n    configurable: false,\r\n    enumerable: true\r\n  });\r\n\r\n  // Per-brick runtime state container (isolated from public surface)\r\n  Object.defineProperty(this, '_runtime', {\r\n    value: {},\r\n    writable: false,\r\n    configurable: false,\r\n    enumerable: false\r\n  });\r\n\r\n  // Reference to global controllers via _controllers object\r\n  // We keep it as an object for potential future per-brick overrides or state containment\r\n  Object.defineProperty(this, '_controllers', {\r\n    value: globalThis.VanillaBrick.runtime.controllers,\r\n    writable: false,\r\n    configurable: false,\r\n    enumerable: false\r\n  });\r\n\r\n  // Initialize controllers with this brick instance\r\n  const brick = this;\r\n  const ctrl = this._controllers;\r\n\r\n  // 1. Init Controllers\r\n  if (ctrl.status) ctrl.status.init(brick);\r\n  if (ctrl.options) ctrl.options.init(brick, opts);\r\n  if (ctrl.events) ctrl.events.init(brick);\r\n  if (ctrl.extensions) ctrl.extensions.init(brick);\r\n\r\n  // 2. Apply Extensions\r\n  // This triggers the whole extension loading pipeline\r\n  if (ctrl.extensions) {\r\n    ctrl.extensions.applyAll(brick);\r\n  }\r\n\r\n  // 3. Set Initial Status\r\n  if (ctrl.status) {\r\n    ctrl.status.set(brick, 'ready', { options: opts });\r\n  }\r\n}\r\n\r\nBrick.prototype.destroy = function () {\r\n  this._controllers.status.set(this, 'destroyed');\r\n  // Optional: clear runtime state to release references eagerly\r\n  if (this._runtime) {\r\n    this._runtime.status = {};\r\n    this._runtime.options = {};\r\n    this._runtime.events = {};\r\n    this._runtime.extensions = {};\r\n  }\r\n};\r\n\r\nObject.defineProperty(Brick, '_idCounter', {\r\n  value: 0,\r\n  writable: true,\r\n  configurable: false,\r\n  enumerable: false\r\n});\r\n\r\nObject.defineProperty(Brick.prototype, '_nextId', {\r\n  value: function () {\r\n    Brick._idCounter += 1;\r\n    return 'brick-' + Brick._idCounter;\r\n  },\r\n  writable: false,\r\n  configurable: false,\r\n  enumerable: false\r\n});\r\n", "// Retorna un array amb totes les definicions d'extensions d'un objecte font\r\nconst ExtensionsRegistry = {\r\n  /**\r\n   * Retorna un array amb totes les definicions d'extensions\r\n   * definides a la font (habitualment l'objecte d'extensions passat)\r\n   */\r\n  _cache: {},\r\n\r\n  /**\r\n   * Retorna un array amb totes les definicions d'extensions\r\n   * filtrades per host/kind i amb depend\u00E8ncies resoltes (topological sort).\r\n   *\r\n   * @param {Object} brick - Instancia del brick o objecte de metadates {host:'brick', kind:'table'}\n   */\r\n  all: function (brick) {\r\n    if (!brick || typeof brick !== 'object') {\r\n      console.warn('ExtensionsRegistry.all() called without brick context');\r\n      return [];\r\n    }\r\n\r\n    const host = (brick.host || 'brick').toLowerCase();\r\n    const kind = (brick.kind || '').toLowerCase();\r\n    if (!kind) return [];\r\n\r\n    const cacheKey = host + '::' + kind;\r\n    if (this._cache[cacheKey]) {\r\n      return this._cache[cacheKey];\r\n    }\r\n\r\n    const src = (globalThis.VanillaBrick && globalThis.VanillaBrick.extensions) || {};\r\n    const candidates = {};\r\n    const seenExtensions = new Set();\r\n\r\n    function normalizeRule(rule) {\r\n      if (!rule || typeof rule !== 'object') return null;\r\n      const rHost = (rule.host || 'brick').toLowerCase();\r\n      const rKind = typeof rule.kind === 'string' ? rule.kind.toLowerCase() : '';\r\n      if (!rKind) return null;\r\n      return { host: rHost, kind: rKind };\r\n    }\r\n\r\n    function matchesRule(rule, currentHost, currentKind) {\r\n      if (!rule) return false;\r\n      const hostMatch = rule.host === '*' || rule.host === currentHost;\r\n      const kindMatch = rule.kind === '*' || rule.kind === currentKind;\r\n      return hostMatch && kindMatch;\r\n    }\r\n\r\n    // 1. Initial Filter by host/kind (and prepare candidates map)\r\n    for (const key in src) {\r\n      if (!Object.prototype.hasOwnProperty.call(src, key)) continue;\r\n      const def = src[key];\r\n      if (!def || typeof def !== 'object') continue;\r\n\r\n      // Skip if we've already seen this exact extension definition object\r\n      if (seenExtensions.has(def)) continue;\r\n\r\n      // Normalitzar el nom intern\r\n      if (!def._name) def._name = def.ns || key;\r\n\r\n      const rules = def.for;\r\n      if (!Array.isArray(rules) || !rules.length) {\r\n        console.warn('VanillaBrick extension without valid `for` array, skipped', def._name || key);\r\n        continue;\r\n      }\r\n\r\n      let match = false;\r\n      for (let ri = 0; ri < rules.length; ri += 1) {\r\n        const rule = normalizeRule(rules[ri]);\r\n        if (!rule) continue;\r\n        if (matchesRule(rule, host, kind)) {\r\n          match = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (match) {\r\n        candidates[key] = { name: key, ext: def };\r\n        seenExtensions.add(def);\r\n      }\r\n    }\r\n\r\n    // 2. Recursive Validation & Topological Sort (DFS)\r\n    const sortedList = [];\r\n    // Status: undefined (unvisited), 'visiting', 'ok', 'missing'\r\n    const status = {};\r\n\r\n    function visit(name) {\r\n      if (status[name] === 'ok') return true;\r\n      if (status[name] === 'visiting') return false; // Cycle detection\r\n      if (status[name] === 'missing') return false;\r\n\r\n      let candidate = candidates[name];\r\n\r\n      // If not found by name, search for a candidate with matching .ns\r\n      if (!candidate) {\r\n        for (const k in candidates) {\r\n          if (candidates[k].ext.ns === name) {\r\n            candidate = candidates[k];\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!candidate) {\r\n        status[name] = 'missing';\r\n        return false;\r\n      }\r\n\r\n      status[name] = 'visiting';\r\n\r\n      const reqs = candidate.ext.requires || candidate.ext._requires;\r\n      if (Array.isArray(reqs)) {\r\n        for (let i = 0; i < reqs.length; i++) {\r\n          const depName = reqs[i];\r\n          if (!visit(depName)) {\r\n            status[name] = 'missing'; // Dependency failed\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n\r\n      status[name] = 'ok';\r\n      sortedList.push(candidate);\r\n      return true;\r\n    }\r\n\r\n    for (const name in candidates) {\r\n      visit(name);\r\n    }\r\n\r\n    this._cache[cacheKey] = sortedList;\r\n    return sortedList;\r\n  },\r\n\r\n  /**\r\n   * Genera els prototips i contextos per a un brick espec\u00EDfic o de forma gen\u00E8rica.\r\n   * Aquesta funci\u00F3 es crida una vegada per tipus d'extensi\u00F3 per generar els \"motlles\".\r\n   */\r\n  _bake: function (defs) {\r\n    const prototypes = {};\r\n\r\n    for (let i = 0; i < defs.length; i++) {\r\n      const def = defs[i];\r\n      const name = def.name || def.ext.ns;\r\n\r\n      // 1. Prototype for the extension context (ctxExt)\r\n      // Contains the extension definition and helper methods.\r\n      // 'brick' will be assigned at instantiation time.\r\n      const protoExt = {\r\n        _name: name,\r\n        _def: def.ext\r\n      };\r\n\r\n      // Bake internal extension methods into the prototype\r\n      // This ensures 'this._helper()' works inside init/destroy/handlers\r\n      if (def.ext.extension && typeof def.ext.extension === 'object') {\r\n        for (const k in def.ext.extension) {\r\n          if (typeof def.ext.extension[k] === 'function') {\r\n            protoExt[k] = def.ext.extension[k];\r\n          }\r\n        }\r\n      }\r\n\r\n      // 2. Prototype for the API context (ctxApi)\r\n      // Contains the 'brick' API methods exposed by this extension.\r\n      // These methods are bound to ctxApi, which has access to ctxExt.\r\n      const protoApi = {};\r\n\r\n      // Bake API methods\r\n      if (def.ext.brick) {\r\n        for (const k in def.ext.brick) {\r\n          if (typeof def.ext.brick[k] === 'function') {\r\n            // We use a closure here to trap 'name' and 'k' correctly\r\n            (function (methodName, methodFn, extName) {\r\n              protoApi[methodName] = function () {\r\n                // This function will be called on the namespace object (e.g. brick.table.refresh())\n                // We need to find the specific context for this extension instance\r\n\r\n                // 'this' is the namespace object (brick[ns])\r\n                // It contains _extData map: { extName: { ctx: ctxApi, fns:..., meta:... } }\r\n                const extData = this._extData && this._extData[extName];\r\n\r\n                if (!extData) {\r\n                  console.warn(`VanillaBrick: Extension data not found for ${extName} in namespace API call ${methodName}`);\r\n                  return;\r\n                }\r\n\r\n                const args = Array.prototype.slice.call(arguments);\r\n                const runtime = (globalThis.VanillaBrick) ? globalThis.VanillaBrick.runtime : null;\r\n\r\n                if (runtime && typeof runtime.execute === 'function') {\r\n                  // Metadata for debugging/tracing\r\n                  const meta = {\r\n                    type: 'brick-api',\r\n                    ext: extName,\r\n                    brick: extData.ctx.brick ? extData.ctx.brick.id : 'unknown',\r\n                    fnName: methodName\r\n                  };\r\n                  return runtime.execute(methodFn, extData.ctx, args, meta);\r\n                }\r\n\r\n                return methodFn.apply(extData.ctx, args);\r\n              };\r\n            })(k, def.ext.brick[k], name);\r\n          }\r\n        }\r\n      }\r\n\r\n      prototypes[name] = {\r\n        ext: protoExt,\r\n        api: protoApi\r\n      };\r\n    }\r\n\r\n    return prototypes;\r\n  }\r\n};\r\n\r\nexport default ExtensionsRegistry;\r\n\r\n", "/**\r\n * Runtime controller (Global Singleton)\r\n * Wraps all developer code execution from extensions.\r\n * Provides centralized error handling and metadata capture for debugging.\r\n * @constructor\r\n */\r\nexport default function RuntimeController() {\r\n    // No per-brick state\r\n}\r\n\r\n/**\r\n * Execute developer code with error handling and metadata capture.\r\n * \r\n * @param {Function} fn - The function to execute\r\n * @param {Object} context - The 'this' context for the function\r\n * @param {Array} args - Arguments to pass to the function\r\n * @param {Object} meta - Metadata for debugging\r\n *   - type: 'event' | 'init' | 'destroy' | 'brick-api' | 'extension-private'\r\n *   - ext: extension name\r\n *   - brick: brick.id (optional)\r\n */\r\nRuntimeController.prototype.execute = function (fn, context, args, meta) {\r\n    \"use strict\";\r\n    if (typeof fn !== 'function') {\r\n        const brickId = (meta && meta.brick) || (context && context.brick && context.brick.id) || 'unknown';\r\n        console.warn(`[RuntimeController] Attempted to execute non-function for brick ${brickId}`, meta);\r\n        return undefined;\r\n    }\r\n\r\n    try {\r\n        const result = fn.apply(context, args);\r\n\r\n        // Support async functions\r\n        if (result && typeof result.then === 'function') {\r\n            return result.catch(function (err) {\r\n                this._handleError(err, fn, context, meta);\r\n                return Promise.reject(err);\r\n            }.bind(this));\r\n        }\r\n\r\n        return result;\r\n    } catch (err) {\r\n        this._handleError(err, fn, context, meta);\r\n        throw err;\r\n    }\r\n};\r\n\r\n/**\r\n * Handle errors from developer code execution.\r\n * Logs detailed information including source code for debugging.\r\n */\r\nRuntimeController.prototype._handleError = function (err, fn, context, meta) {\r\n    var brickCtx = (context && context.brick) ? context.brick : context;\r\n    // If context is weird, try to get brick from meta or fallback\r\n    if (!brickCtx || !brickCtx.id) {\r\n        if (meta && meta.brick) {\r\n            brickCtx = { id: meta.brick };\r\n        }\r\n    }\r\n\r\n    const errorInfo = {\r\n        error: err,\r\n        message: err.message || String(err),\r\n        stack: err.stack,\r\n        meta: meta || {},\r\n        context: {\r\n            brick: brickCtx && brickCtx.id ? brickCtx.id : null,\r\n            kind: brickCtx && brickCtx.kind ? brickCtx.kind : null\r\n        }\r\n    };\r\n\r\n    // Try to capture function source for debugging\r\n    try {\r\n        errorInfo.fnSource = fn.toString();\r\n    } catch (e) {\r\n        errorInfo.fnSource = '[unable to capture source]';\r\n    }\r\n\r\n    console.error('[RuntimeController] Error executing developer code:', errorInfo);\r\n};\r\n", "/**\r\n * Status Controller (Global Singleton)\r\n * Manages the lifecycle state of a brick (init, ready, destroyed, etc.)\r\n * @constructor\r\n */\r\nexport default function StatusController() {\r\n    // No per-brick state here\r\n}\r\n\r\n/**\r\n * Initialize status for a brick\r\n * @param {Object} brick\r\n */\r\nStatusController.prototype.init = function (brick) {\r\n    if (!brick || !brick._runtime) return;\r\n    brick._runtime.status = {\r\n        value: 'initializing',\r\n        listening: true\r\n    };\r\n\r\n    const self = this;\r\n    brick.status = {\r\n        get: () => self.get(brick),\r\n        set: (status, payload) => self.set(brick, status, payload),\r\n        is: (status) => self.is(brick, status)\r\n    }\r\n  };\r\n\r\n/**\r\n * Get current status\r\n */\r\nStatusController.prototype.get = function (brick) {\r\n    return brick && brick._runtime && brick._runtime.status ? brick._runtime.status.value : undefined;\r\n};\r\n\r\n/**\r\n * Check if current status matches\r\n */\r\nStatusController.prototype.is = function (brick, status) {\r\n    if (!brick || !brick._runtime || !brick._runtime.status) return false;\r\n    return brick._runtime.status.value === status;\r\n};\r\n\r\n/**\r\n * Set status and fire event\r\n */\r\nStatusController.prototype.set = function (brick, newStatus, payload) {\r\n    if (!brick || !brick._runtime || !brick._runtime.status) return;\r\n    const state = brick._runtime.status;\r\n    if (!state.listening) return;\r\n    if (state.value === newStatus) return;\r\n\r\n    const oldStatus = state.value;\r\n    state.value = newStatus;\r\n\r\n    // Fire generic change event\r\n    if (brick.events) {\r\n        brick.events.fire('brick:status:change', {\r\n            from: oldStatus,\r\n            to: newStatus,\r\n            ...payload\r\n        });\r\n\r\n        // Fire specific event (e.g. brick:status:ready)\r\n        brick.events.fire('brick:status:' + newStatus, payload);\r\n    }\r\n\r\n    if (newStatus === 'destroyed') {\r\n        state.listening = false;\r\n        // Cleanup events maybe? managed by destroy hook usually\r\n    }\r\n};\r\n", "/**\r\n * Merges option objects with priority: last arguments override previous ones.\r\n * Handles nested objects (deep merge) but arrays are replaced.\r\n */\r\nexport function mergeOptions() {\r\n  const result = {};\r\n\r\n  for (let i = 0; i < arguments.length; i++) {\r\n    const source = arguments[i];\r\n    if (!source || typeof source !== 'object') continue;\r\n\r\n    for (const key in source) {\r\n      if (!Object.prototype.hasOwnProperty.call(source, key)) continue;\r\n\r\n      const sVal = source[key];\r\n      const rVal = result[key];\r\n\r\n      if (\r\n        sVal &&\r\n        typeof sVal === 'object' &&\r\n        !Array.isArray(sVal) &&\r\n        rVal &&\r\n        typeof rVal === 'object' &&\r\n        !Array.isArray(rVal)\r\n      ) {\r\n        // Deep merge objects\r\n        result[key] = mergeOptions(rVal, sVal);\r\n      } else {\r\n        // Replace primitives and arrays\r\n        result[key] = sVal; // Shallow copy enough for config usually, or clone if needed\r\n      }\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Gets a value from an object using dot notation path (e.g. \"table.columns.0.width\")\n */\r\nexport function getOption(obj, path) {\r\n  if (!obj || !path) return undefined;\r\n  if (!path.indexOf('.')) return obj[path];\r\n\r\n  const parts = path.split('.');\r\n  let current = obj;\r\n  for (let i = 0; i < parts.length; i++) {\r\n    if (current === undefined || current === null) return undefined;\r\n    current = current[parts[i]];\r\n  }\r\n  return current;\r\n}\r\n\r\n/**\r\n * Sets a value in an object using dot notation path, creating intermediate objects.\r\n */\r\nexport function setOption(obj, path, value) {\r\n  if (!obj || !path) return;\r\n\r\n  const parts = path.split('.');\r\n  let current = obj;\r\n\r\n  for (let i = 0; i < parts.length - 1; i++) {\r\n    const p = parts[i];\r\n    if (current[p] === undefined || current[p] === null) {\r\n      current[p] = {};\r\n    }\r\n    current = current[p];\r\n  }\r\n\r\n  current[parts[parts.length - 1]] = value;\r\n}\r\n", "import { mergeOptions, getOption, setOption } from '../utils/options.js';\r\n\r\n/**\r\n * Options Controller (Global Singleton)\r\n * Manages configuration, defaults, and reactive updates for options.\r\n * @constructor\r\n */\r\nexport default function OptionsController() {\r\n  // No per-brick state here.\r\n}\r\n\r\n/**\r\n * Initialize options for a brick\r\n * @param {Object} brick\r\n * @param {Object} initialOptions\r\n */\r\nOptionsController.prototype.init = function (brick, initialOptions) {\r\n  if (!brick || !brick._runtime) return;\r\n  brick._runtime.options = {\r\n    data: initialOptions || {},\r\n    cache: {}\r\n  };\r\n\r\n    // Create public API\r\n  const self = this;\r\n  brick.options = {\r\n    get: function (key, fallback) {\r\n      return  self.get(brick, key, fallback); \r\n    },\r\n    set: function(key, value) {\r\n      self.setSync(brick, key, value);\r\n      return brick;\r\n    },\r\n    setAsync: async function(key, value)  {\r\n      await self.setAsync(brick, key, value);\r\n      return brick;\r\n    },\r\n    has: function(key) { return self.has(brick, key)} ,\r\n    all: function()  {self.all(brick)},\r\n    setSilent:function (key, value)  {\r\n      self.setSilent(brick, key, value);\r\n      return brick;\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * Get the full options object (resolved).\r\n */\r\nOptionsController.prototype.all = function (brick) {\r\n  return (brick && brick._runtime && brick._runtime.options) ? brick._runtime.options.data : {};\r\n};\r\n\r\n/**\r\n * Check if an option exists.\r\n */\r\nOptionsController.prototype.has = function (brick, key) {\r\n  const data = (brick && brick._runtime && brick._runtime.options) ? brick._runtime.options.data : {};\r\n  const val = getOption(data, key);\r\n  return val !== undefined;\r\n};\r\n\r\n/**\r\n * Get an option value with fallback.\r\n */\r\nOptionsController.prototype.get = function (brick, key, fallback) {\r\n  const state = (brick && brick._runtime) ? brick._runtime.options : null;\r\n  if (!state) return fallback;\r\n\r\n  // Check cache first (for simple keys or previously resolved deep keys)\r\n  if (state.cache && Object.prototype.hasOwnProperty.call(state.cache, key)) {\r\n    return state.cache[key];\r\n  }\r\n\r\n  const val = getOption(state.data, key);\r\n  const result = (val === undefined) ? fallback : val;\r\n\r\n  // Cache the result\r\n  if (state.cache) {\r\n    state.cache[key] = result;\r\n  }\r\n  return result;\r\n};\r\n\r\n/**\r\n * Set an option value synchronously.\r\n * Triggers 'option:changed' and specific 'option:changed:key'.\r\n */\r\nOptionsController.prototype.setSync = function (brick, key, value) {\r\n  const state = (brick && brick._runtime) ? brick._runtime.options : null;\r\n  if (!state) return;\r\n\r\n  const old = this.get(brick, key);\r\n  if (old === value) return; // No change\r\n\r\n  setOption(state.data, key, value);\r\n\r\n  // Invalidate cache\r\n  state.cache = {};\r\n\r\n  // Fire change events\r\n  if (brick.events) {\r\n    brick.events.fire('brick:option:changed', { key: key, value: value, oldValue: old });\r\n    brick.events.fire('brick:option:changed:' + key, { value: value, oldValue: old });\r\n  }\r\n};\r\n\r\n/**\r\n * Set an option value silently (no events).\r\n */\r\nOptionsController.prototype.setSilent = function (brick, key, value) {\r\n  const state = (brick && brick._runtime) ? brick._runtime.options : null;\r\n  if (!state) return;\r\n\r\n  setOption(state.data, key, value);\r\n  // Invalidate cache\r\n  state.cache = {};\r\n};\r\n\r\n/**\r\n * Set an option value asynchronously (supports validation/middleware if expanded).\r\n */\r\nOptionsController.prototype.setAsync = async function (brick, key, value) {\r\n  this.setSync(brick, key, value);\r\n  return Promise.resolve();\r\n};\r\n", "/**\r\n * Event Bus Controller (Global Singleton)\r\n * Manages events shaped as \"namespace:event:target\" with phases before/on/after.\r\n * @constructor\r\n */\r\nexport default function EventBusController() {\r\n  // No per-brick state here yet (will use WeakMap later)\r\n  this.phases = ['before', 'on', 'after']; // Shared constant\r\n}\r\n\r\n/**\r\n * Initialize event bus for a brick\r\n */\r\nEventBusController.prototype.init = function (brick) {\r\n  if (!brick || !brick._runtime) return;\r\n\r\n  // Initialize per-brick state\r\n  brick._runtime.events = {\r\n    handlers: [],\r\n    dispatchCache: {}\r\n  };\r\n\r\n  // Create public API\r\n  const self = this;\r\n  brick.events = {\r\n    on: function (pattern, phase, priority, handler, meta) {\r\n      self.on(brick, pattern, phase, priority, handler, meta);\r\n      return brick;\r\n    },\r\n    off: function (pattern, phase, handler) {\r\n      self.off(brick, pattern, phase, handler);\r\n      return brick;\r\n    },\r\n    fire: function (eventName, payload) {\r\n      self.fire(brick, eventName, payload);\r\n      return brick;\r\n    },\r\n    fireAsync: function (eventName, payload) {\r\n      return self.fireAsync(brick, eventName, payload);\r\n    }\r\n  };\r\n};\r\n\r\n// ---------- Internal utils ----------\r\n\r\nEventBusController.prototype._normalizePriority = function (priority) {\r\n  let pr = typeof priority === 'number' ? priority : 5;\r\n  if (pr < 0) pr = 0;\r\n  if (pr > 10) pr = 10;\r\n  return pr;\r\n};\r\n\r\n/**\r\n * Compiles a subscription pattern.\r\n * Pattern format: \"namespace:type:target\"\r\n * Supports '*' as wildcard in any position.\r\n */\r\nEventBusController.prototype._compilePattern = function (pattern) {\r\n  const parts = (pattern || '').split(':');\r\n  const ns = parts[0];\r\n  const type = parts[1];\r\n  const target = parts[2];\r\n\r\n  return {\r\n    namespace: !ns || ns === '*' ? undefined : ns,\r\n    type: !type || type === '*' ? undefined : type,\r\n    target: !target || target === '*' ? undefined : target,\r\n  };\r\n};\r\n\r\n/**\r\n * Parses an event name into its components.\r\n * Format: \"namespace:type:target\"\r\n */\r\nEventBusController.prototype._parseEventKey = function (eventName) {\r\n  const parts = (eventName || '').split(':');\r\n  return {\r\n    namespace: parts[0] || '',\r\n    type: parts[1] || '',\r\n    target: parts[2] || '',\r\n  };\r\n};\r\n\r\nEventBusController.prototype._matches = function (compiled, key) {\r\n  return (\r\n    (compiled.namespace === undefined || compiled.namespace === key.namespace) &&\r\n    (compiled.type === undefined || compiled.type === key.type) &&\r\n    (compiled.target === undefined || compiled.target === key.target)\r\n  );\r\n};\r\n\r\nEventBusController.prototype._validateEventName = function (eventName) {\r\n  if (typeof eventName !== 'string') {\r\n    console.error('[EventBus] Event name must be a string.', eventName);\r\n    return false;\r\n  }\r\n  const parts = eventName.split(':');\r\n\r\n  // Strict 3-segment rule\r\n  if (parts.length !== 3) {\r\n    console.error('[EventBus] Invalid event name format. Expected exactly \"namespace:type:target\" (3 segments). Got:', eventName);\r\n    return false;\r\n  }\r\n\r\n  // Validation for Dispatch: No empty parts, no wildcards allowed\r\n  if (!parts[0] || parts[0] === '*' || !parts[1] || parts[1] === '*' || !parts[2] || parts[2] === '*') {\r\n    console.error('[EventBus] Invalid event name for dispatch. Wildcards (*) and empty segments are not allowed in namespace, type, or target.', eventName);\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n/**\r\n * Returns matched handlers grouped by phase for a specific event name.\r\n * Uses caching. The cache key is the full eventName string.\r\n */\r\nEventBusController.prototype._getHandlersForEvent = function (brick, eventName, phase) {\r\n  if (!brick || !brick._runtime || !brick._runtime.events) return phase ? [] : { before: [], on: [], after: [] };\r\n  const state = brick._runtime.events;\r\n  let handlersByPhase;\r\n\r\n  if (state.dispatchCache[eventName]) {\r\n    handlersByPhase = state.dispatchCache[eventName];\r\n  } else {\r\n    const key = this._parseEventKey(eventName);\r\n    handlersByPhase = {\r\n      before: [],\r\n      on: [],\r\n      after: []\r\n    };\r\n\r\n    for (let i = 0; i < state.handlers.length; i += 1) {\r\n      const h = state.handlers[i];\r\n      if (this._matches(h.compiled, key)) {\r\n        if (handlersByPhase[h.phase]) {\r\n          handlersByPhase[h.phase].push(h);\r\n        }\r\n      }\r\n    }\r\n    state.dispatchCache[eventName] = handlersByPhase;\r\n  }\r\n\r\n  if (phase) {\r\n    return handlersByPhase[phase] || [];\r\n  }\r\n\r\n  return handlersByPhase;\r\n};\r\n\r\n// ---------- Subscription API ----------\r\n\r\n/**\r\n * Register a handler for a pattern and phase.\r\n * pattern: \"namespace:type:target\" (supports '*')\r\n * phase: \"before\" | \"on\" | \"after\" (default \"on\")\r\n * priority: 0..10 (default 5, 0 = highest priority)\r\n */\r\nEventBusController.prototype.on = function (brick, pattern, phase, priority, handler, meta) {\r\n  // Signature compatibility: on(pattern, phase, priority, handler, meta)\r\n  // Optional args shifting\r\n  if (typeof phase === 'function') {\r\n    meta = handler;\r\n    handler = phase;\r\n    phase = 'on';\r\n    priority = undefined;\r\n  } else if (typeof priority === 'function' && typeof handler !== 'function') {\r\n    meta = handler;\r\n    handler = priority;\r\n    priority = undefined;\r\n  }\r\n  if (!handler) return;\r\n  // handler can be a function OR an object { fn, ctx, meta }\r\n\r\n  let ph = phase || 'on';\r\n  if (this.phases.indexOf(ph) === -1) ph = 'on';\r\n\r\n  const pr = this._normalizePriority(priority);\r\n\r\n  const state = brick._runtime.events;\r\n\r\n  state.handlers.push({\r\n    pattern: pattern,\r\n    compiled: this._compilePattern(pattern),\r\n    phase: ph,\r\n    handler: handler,\r\n    priority: pr,\r\n    meta: meta || null\r\n  });\r\n\r\n  // Sort by priority asc (0 = first)\r\n  state.handlers.sort(function (a, b) {\r\n    const pa = typeof a.priority === 'number' ? a.priority : 5;\r\n    const pb = typeof b.priority === 'number' ? b.priority : 5;\r\n    return pa - pb;\r\n  });\r\n\r\n  // Invalidate cache on any subscription change\r\n  state.dispatchCache = {};\r\n};\r\n\r\n/**\r\n * Unregister handlers filtered by pattern, phase and/or handler.\r\n */\r\nEventBusController.prototype.off = function (brick, pattern, phase, handler) {\r\n  if (!brick || !brick._runtime || !brick._runtime.events) return;\r\n  const state = brick._runtime.events;\r\n\r\n  for (let i = state.handlers.length - 1; i >= 0; i -= 1) {\r\n    const h = state.handlers[i];\r\n    if (pattern && h.pattern !== pattern) continue;\r\n    if (phase && h.phase !== phase) continue;\r\n    if (handler && h.handler !== handler) continue;\r\n    state.handlers.splice(i, 1);\r\n  }\r\n  // Invalidate cache on any unsubscription\r\n  state.dispatchCache = {};\r\n};\r\n\r\n// ---------- Pipeline execution (async core) ----------\r\n\r\n/**\r\n * Internal phase execution.\r\n */\r\nEventBusController.prototype._firePhase = async function (brick, phase, eventName, ev) {\r\n  ev.event.phase = phase;\r\n  ev.stopPhase = false;\r\n\r\n  const phaseHandlers = this._getHandlersForEvent(brick, eventName, phase);\r\n  const runtime = (globalThis.VanillaBrick) ? globalThis.VanillaBrick.runtime : null;\r\n\r\n  for (let i = 0; i < phaseHandlers.length; i += 1) {\r\n    if (ev.stopPhase) break;\r\n\r\n    const h = phaseHandlers[i];\r\n    const hnd = h.handler;\r\n\r\n    try {\r\n      let r;\r\n      if (hnd && typeof hnd === 'object' && typeof hnd.fn === 'function') {\r\n        // Execute via descriptor (Extension Handler)\r\n        if (runtime) {\r\n          r = runtime.execute(hnd.fn, hnd.ctx, [ev], hnd.meta);\r\n        } else {\r\n          r = hnd.fn.apply(hnd.ctx, [ev]);\r\n        }\r\n      } else if (typeof hnd === 'function') {\r\n        // Legacy/Direct function case\r\n        if (runtime) {\r\n          r = runtime.execute(hnd, { brick: brick }, [ev], h.meta);\r\n        } else {\r\n          r = hnd(ev, { brick: brick });\r\n        }\r\n      }\r\n\r\n      if (r && typeof r.then === 'function') {\r\n        await r;\r\n      }\r\n    } catch (err) {\r\n      console.error('Error in event handler execution:', err, { h, eventName, phase });\r\n      ev.errors.push({ error: err, phase: phase, event: eventName });\r\n      ev.cancel = true;\r\n    }\r\n  }\r\n\r\n  return ev;\r\n};\r\n\r\nEventBusController.prototype._run = async function (brick, eventName, payload) {\r\n  if (!brick || !brick._runtime || !brick._runtime.events) {\r\n    return {\r\n      event: { name: eventName },\r\n      errors: [{ error: 'Event system not initialized for this brick' }],\r\n      cancel: true\r\n    };\r\n  }\r\n\r\n  // 1. Validation\r\n  if (!this._validateEventName(eventName)) {\r\n    return {\r\n      event: { name: eventName },\r\n      errors: [{ error: 'Invalid event name format or wildcards in dispatch' }],\r\n      cancel: true\r\n    };\r\n  }\r\n\r\n  // 2. Context Initialization\r\n  const key = this._parseEventKey(eventName);\r\n  const ev = {\r\n    brick: brick || null,\r\n    cancel: false,\r\n    data: payload,\r\n    errors: [],\r\n    event: {\r\n      phase: null,\r\n      name: eventName,\r\n      namespace: key.namespace,\r\n      type: key.type,\r\n      target: key.target,\r\n    },\r\n    stopPhase: false,\r\n  };\r\n\r\n  // 3. Sequential Phase Execution\r\n  const phases = this.phases;\r\n  for (let p = 0; p < phases.length; p += 1) {\r\n    const phase = phases[p];\r\n    if (phase === 'on' && ev.cancel) continue;\r\n    await this._firePhase(brick, phase, eventName, ev);\r\n  }\r\n\r\n  return ev;\r\n};\r\n\r\n// ---------- Public API ----------\r\n\r\n/**\r\n * Fire-and-forget event.\r\n * eventName: \"namespace:type:target\"\r\n */\r\nEventBusController.prototype.fire = function (brick, eventName, payload) {\r\n  // Fire-and-forget; use fireAsync() if you need the final event object.\r\n  this._run(brick, eventName, payload);\r\n};\r\n\r\n/**\r\n * Fire an event and get a Promise with the final event object\r\n * (to inspect cancel/errors/meta).\r\n */\r\nEventBusController.prototype.fireAsync = function (brick, eventName, payload) {\r\n  return this._run(brick, eventName, payload);\r\n};\r\n", "import ExtensionsRegistry from './extensionsRegistry.js';\r\nimport { mergeOptions } from '../utils/options.js';\r\n\r\nfunction parseForPattern(pattern) {\r\n  if (!pattern) return { ns: '', action: '', target: '*' };\r\n  const bits = String(pattern).split(':');\r\n  const ns = bits[0] || '';\r\n  const action = bits[1] || '';\r\n  let target = bits.length > 2 ? bits.slice(2).join(':') : '*';\r\n  if (!target) target = '*';\r\n  return { ns: ns, action: action, target: target };\r\n}\r\n\r\n/**\r\n * Extensions Controller (Global Singleton)\r\n */\r\nexport default function ExtensionsController() {\r\n  // No state here\r\n}\r\n\r\nfunction getRuntime() {\r\n  return (globalThis.VanillaBrick && globalThis.VanillaBrick.runtime) ? globalThis.VanillaBrick.runtime : null;\r\n}\r\n\r\n/**\r\n * Initialize extensions for a brick\r\n */\r\nExtensionsController.prototype.init = function (brick) {\r\n  if (!brick || !brick._runtime) return;\r\n  brick._runtime.extensions = {\r\n    map: {}, // Map of installed extensions { name: ctxExt }\r\n    destroyHook: false\r\n  };\r\n};\r\n\r\nExtensionsController.prototype.applyAll = function (brick) {\r\n  const registry = ExtensionsRegistry;\r\n  if (!registry || typeof registry.all !== 'function') return;\r\n\r\n  // Now registry returns a filtered, sorted, valid list\r\n  const defs = registry.all(brick) || [];\r\n\r\n  if (defs.length == 0) {\r\n    return;\r\n  }\r\n\r\n  const runtime = getRuntime();\r\n\r\n  // Ensure prototypes are baked (cached globally)\r\n  if (runtime) {\r\n    if (!runtime.prototypes) {\r\n      runtime.prototypes = {};\r\n    }\r\n    // Check if we need to bake prototypes for these defs\r\n    // We bake ALL returned defs just in case they are new\r\n    const baked = registry._bake(defs);\r\n    Object.assign(runtime.prototypes, baked);\r\n  }\r\n\r\n  // Phase 1: merge options before any init()\r\n  const optionsCtrl = brick._controllers && brick._controllers.options;\r\n\r\n  if (!mergeOptions || typeof mergeOptions !== 'function') {\r\n    console.error('mergeOptions is missing; cannot merge extension defaults safely');\r\n  } else if (optionsCtrl && typeof optionsCtrl.get === 'function') { // Check for .get instead of .all to be safe, or just existence\r\n    // Get current user options\r\n    const userOptions = (brick._runtime && brick._runtime.options) ? brick._runtime.options.data : {};\r\n    const kind = (brick.kind || '').toLowerCase();\r\n    const coreDefaults = [];\r\n    const extDefaults = [];\r\n\r\n    for (let i = 0; i < defs.length; i += 1) {\r\n      const def = defs[i];\r\n      const defOpts = def.ext.options || def.ext._options;\r\n      if (!defOpts) continue;\r\n      const defName = (def.ext.ns || def.name || '').toLowerCase();\r\n      if (defName && kind && defName === kind + '-core') {\r\n        coreDefaults.push(defOpts);\r\n      } else {\r\n        extDefaults.push(defOpts);\r\n      }\r\n    }\r\n\r\n    const mergedOptions = mergeOptions.apply(null, coreDefaults.concat(extDefaults, [userOptions]));\r\n\r\n    // Update brick options directly\r\n    if (brick._runtime && brick._runtime.options) {\r\n      brick._runtime.options.data = mergedOptions;\r\n      brick._runtime.options.cache = {};\r\n    }\r\n  }\r\n\r\n  // Phase 2: install + init extensions\r\n  for (let i = 0; i < defs.length; i += 1) {\r\n    this._install(brick, defs[i]);\r\n  }\r\n\r\n  this._ensureDestroyHook(brick);\r\n};\r\n\r\nExtensionsController.prototype._install = function (brick, def) {\r\n  const name = def.name || def.ext.ns || null;\r\n  const ns = def.ext.ns || name;\r\n\r\n  if (!name) {\r\n    console.warn('VanillaBrick extension without name/ns, skipped', def);\r\n    return;\r\n  }\r\n\r\n  const extState = (brick && brick._runtime) ? brick._runtime.extensions : null;\r\n  if (!extState) return;\r\n  if (extState.map[name]) return;\r\n\r\n  // Get baked prototypes if available\r\n  const runtime = getRuntime();\r\n  const protos = (runtime && runtime.prototypes) ? runtime.prototypes[name] : null;\r\n\r\n  let ctxExt;\r\n  if (protos && protos.ext) {\r\n    // Create extension context from prototype\r\n    ctxExt = Object.create(protos.ext);\r\n    // Assign specific instance properties\r\n    ctxExt.brick = brick;\r\n    ctxExt.ext = ctxExt; // self-ref for some legacy code patterns\r\n    ctxExt._ctx = ctxExt;\r\n  } else {\r\n    // Fallback creation\r\n    const ext = {\r\n      name: name,\r\n      def: def.ext,\r\n      brick: brick\r\n    };\r\n    ctxExt = Object.create(ext);\r\n    ctxExt.brick = brick;\r\n    ctxExt.ext = ext;\r\n    ctxExt._ctx = ctxExt;\r\n  }\r\n\r\n  // Inject Core APIs for context compatibility\r\n  // Many legacy extensions expect 'this.options' to refer to the brick's options API\r\n  Object.defineProperty(ctxExt, 'options', { value: brick.options, writable: false, enumerable: false, configurable: true });\r\n  Object.defineProperty(ctxExt, 'events', { value: brick.events, writable: false, enumerable: false, configurable: true });\r\n  Object.defineProperty(ctxExt, 'status', { value: brick.status, writable: false, enumerable: false, configurable: true });\r\n\r\n  // API Context (what 'this' refers to in API methods)\r\n  // Usually it mirrors ctxExt but for API mapping we might separate it conceptually\r\n  const ctxApi = ctxExt;\r\n\r\n  // Attach internal extension methods to ctxExt (if not using prototypes or just to be sure)\r\n  // If prototypes are used, these methods might already be on the prototype chain, \r\n  // but if they are closures defined in the extension object, we might need to bind/wrap them.\r\n  // Ideally, baked prototypes handle this. If NOT using baked prototypes, we do manual wrapping here.\r\n\r\n  if (!protos) {\r\n    // Manual internal method wrapping (Fallback)\r\n    if (def.ext.extension && typeof def.ext.extension === 'object') {\r\n      for (const k in def.ext.extension) {\r\n        if (!Object.prototype.hasOwnProperty.call(def.ext.extension, k)) continue;\r\n        const fn = def.ext.extension[k];\r\n        if (typeof fn === 'function') {\r\n          const meta = { type: 'extension-private', ext: name, brick: brick.id, fnName: k };\r\n          ctxExt[k] = function () {\r\n            const args = Array.prototype.slice.call(arguments);\r\n            if (runtime && typeof runtime.execute === 'function') {\r\n              return runtime.execute(fn, ctxExt, args, meta);\r\n            }\r\n            return fn.apply(ctxExt, args);\r\n          };\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Init hook\r\n  if (typeof def.ext.init === 'function') {\r\n    try {\r\n      let res;\r\n      if (runtime && typeof runtime.execute === 'function') {\r\n        res = runtime.execute(def.ext.init, ctxExt, [], {\r\n          type: 'init',\r\n          ext: name,\r\n          brick: brick.id,\r\n          fnName: 'init'\r\n        });\r\n      } else {\r\n        res = def.ext.init.call(ctxExt);\r\n      }\r\n      if (res === false) return;\r\n    } catch (err) {\r\n      console.error('VanillaBrick extension \"' + name + '\" init() failed', err);\r\n      return;\r\n    }\r\n  }\r\n\r\n  // Expose API on brick namespace\r\n  // This is the CRITICAL part for additive namespaces\r\n  if (def.ext.brick && typeof def.ext.brick === 'object') {\r\n    // Ensure namespace object exists\r\n    if (!brick[ns]) {\r\n      brick[ns] = { _extData: {} };\r\n    }\r\n\r\n    const nsObj = brick[ns];\r\n    if (!nsObj._extData) nsObj._extData = {}; // Safety check if brick[ns] was created by someone else\r\n\r\n    if (protos && protos.api) {\r\n      // Additive merge of baked prototypes\r\n      // The baked methods are generic wrappers that look up _extData[name]\r\n      Object.assign(nsObj, protos.api);\r\n\r\n      // Store the specific data for this extension instance so the generic wrapper can find it\r\n      nsObj._extData[name] = { ctx: ctxApi, fns: def.ext.brick, meta: {} };\r\n    } else {\r\n      // Manual Wrapping (Fallback)\r\n      for (const apiName in def.ext.brick) {\r\n        if (!Object.prototype.hasOwnProperty.call(def.ext.brick, apiName)) continue;\r\n        const apiFn = def.ext.brick[apiName];\r\n        if (typeof apiFn !== 'function') continue;\r\n\r\n        // Warn if overwriting? Ideally properly managed namespaces don't collide on method names\r\n        // if (nsObj[apiName]) console.warn(...)\r\n\r\n        const meta = { type: 'brick-api', ext: name, brick: brick.id, fnName: ns + '.' + apiName };\r\n        nsObj[apiName] = function () {\r\n          const args = Array.prototype.slice.call(arguments);\r\n          if (runtime && typeof runtime.execute === 'function') {\r\n            return runtime.execute(apiFn, ctxApi, args, meta);\r\n          }\r\n          return apiFn.apply(ctxApi, args);\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  // Register event listeners\r\n  if (Array.isArray(def.ext.events) && def.ext.events.length) {\r\n    // Check if events controller API is available on brick (it should be)\r\n    if (brick.events && typeof brick.events.on === 'function') {\r\n      for (let li = 0; li < def.ext.events.length; li += 1) {\r\n        const evt = def.ext.events[li];\r\n        if (!evt) continue;\r\n        const parsed = parseForPattern(evt.for);\r\n        const pattern = parsed.ns + ':' + parsed.action + ':' + parsed.target;\r\n\r\n        ['before', 'on', 'after'].forEach(function (phase) {\r\n          const desc = evt[phase];\r\n          if (!desc || typeof desc.fn !== 'function') return;\r\n\r\n          const pr = (typeof desc.priority === 'number') ? desc.priority : undefined;\r\n          const meta = {\r\n            type: 'event',\r\n            ext: name,\r\n            brick: brick.id,\r\n            event: pattern,\r\n            phase: phase,\r\n            fnName: desc.fn.name || 'anon'\r\n          };\r\n\r\n          // Handler must be bound to extension context\r\n          const handler = function (ev) {\r\n            const args = [ev];\r\n            if (runtime && typeof runtime.execute === 'function') {\r\n              return runtime.execute(desc.fn, ctxExt, args, meta);\r\n            }\r\n            return desc.fn.apply(ctxExt, args);\r\n          };\r\n\r\n          // Use the public or direct API? Direct if we have access, but public is fine too.\r\n          // Using direct call to controller is better inside controller logic\r\n          brick.events.on(pattern, phase, pr, handler, { ext: name, fn: desc.fn.name });\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  extState.map[name] = ctxExt;\r\n};\r\n\r\nExtensionsController.prototype._ensureDestroyHook = function (brick) {\r\n  const extState = (brick && brick._runtime) ? brick._runtime.extensions : null;\r\n  if (!extState) return;\r\n  if (extState.destroyHook) return;\r\n\r\n  if (!brick || !brick.events || typeof brick.events.on !== 'function') {\r\n    return;\r\n  }\r\n\r\n  extState.destroyHook = true;\r\n\r\n  brick.events.on(\r\n    'brick:status:destroyed',\r\n    'on',\r\n    0, // High priority\r\n    function () {\r\n      const runtime = getRuntime();\r\n\r\n      for (const name in extState.map) {\r\n        if (!Object.prototype.hasOwnProperty.call(extState.map, name)) continue;\r\n        const ctxExt = extState.map[name];\r\n        // The def is now inside _def if using prototypes, or def.ext if manual\r\n        // Our context creation put definition in `_def` for baked ones.\r\n        // Let's safe access it.\r\n        const def = (ctxExt._def) ? { destroy: ctxExt._def.destroy, ns: ctxExt._name } : (ctxExt.def || {}); // Fallback\r\n\r\n        if (typeof def.destroy === 'function') {\r\n          try {\r\n            if (runtime && typeof runtime.execute === 'function') {\r\n              runtime.execute(def.destroy, ctxExt, [], {\r\n                type: 'destroy',\r\n                ext: name,\r\n                brick: brick.id,\r\n                fnName: 'destroy'\r\n              });\r\n            } else {\r\n              def.destroy.call(ctxExt);\r\n            }\r\n          } catch (err) {\r\n            console.error('VanillaBrick extension \"' + name + '\" destroy() failed', err);\r\n          }\r\n        }\r\n      }\r\n      extState.map = {};\r\n    }\r\n  );\r\n};\r\n", "export function setupServices(VanillaBrick) {\r\n    // Ensure runtime services registry\r\n    VanillaBrick.runtime.services = VanillaBrick.runtime.services || {};\r\n\r\n    // Public accessor\r\n    VanillaBrick.service = function (name) {\r\n        // Check if running\r\n        if (VanillaBrick.runtime.services[name]) {\r\n            return VanillaBrick.runtime.services[name];\r\n        }\r\n        // Try to start\r\n        return VanillaBrick.base.serviceStart(name);\r\n    };\r\n\r\n    // Internal helpers in base\r\n    VanillaBrick.base.serviceStart = function (name) {\r\n        if (VanillaBrick.runtime.services[name]) {\r\n            return VanillaBrick.runtime.services[name];\r\n        }\r\n\r\n        const def = VanillaBrick.services[name];\r\n        if (!def) {\r\n            console.warn(\"Service definition not found:\", name);\r\n            return null;\r\n        }\r\n\r\n        const opts = Object.assign({}, def);\r\n        opts.id = name; // Service name as ID\r\n        opts.host = 'service';\r\n        opts.kind = opts.kind || 'service';\r\n\r\n        // Create brick instance\r\n        const brick = new VanillaBrick.brick(opts);\r\n\r\n        // Register instance\r\n        VanillaBrick.runtime.services[name] = brick;\r\n\r\n        if (VanillaBrick.runtime.bricks && Array.isArray(VanillaBrick.runtime.bricks)) {\r\n            VanillaBrick.runtime.bricks.push(brick);\r\n        }\r\n\r\n        return brick;\r\n    };\r\n\r\n    VanillaBrick.base.serviceStop = function (name) {\r\n        const service = VanillaBrick.runtime.services[name];\r\n        if (!service) return;\r\n\r\n        if (service.destroy) service.destroy();\r\n\r\n        delete VanillaBrick.runtime.services[name];\r\n    };\r\n}\r\n", "export function setupBootstrap(VanillaBrick) {\r\n  VanillaBrick.base = VanillaBrick.base || {};\r\n  VanillaBrick.configs = VanillaBrick.configs || {};\r\n\r\n  const registry = {\r\n    list: [],\r\n    byId: {},\r\n  };\r\n\r\n  function loadConfigs(scope) {\r\n    if (typeof document === 'undefined') return;\r\n    const root = scope || document;\r\n    if (!root.querySelectorAll) return;\r\n    const scripts = root.querySelectorAll('script[type=\"application/json\"][data-brick]');\r\n    for (let i = 0; i < scripts.length; i += 1) {\r\n      const node = scripts[i];\r\n      const raw = node.textContent || '';\r\n      if (!raw.trim()) continue;\r\n      try {\r\n        const parsed = JSON.parse(raw);\r\n        if (!parsed || typeof parsed !== 'object') continue;\r\n        for (const key in parsed) {\r\n          if (!Object.prototype.hasOwnProperty.call(parsed, key)) continue;\r\n          const base = (VanillaBrick.configs[key] && typeof VanillaBrick.configs[key] === 'object')\r\n            ? VanillaBrick.configs[key]\r\n            : {};\r\n          const next = parsed[key];\r\n          if (!next || typeof next !== 'object') continue;\r\n          VanillaBrick.configs[key] = Object.assign({}, base, next);\r\n        }\r\n      } catch (err) {\r\n        console.warn('VanillaBrick: invalid JSON in data-brick config', err);\r\n      }\r\n    }\r\n  }\r\n\r\n  function readKind(el) {\r\n    if (!el) return undefined;\r\n    // data-kind o data-brick-kind\r\n    const k =\r\n      el.getAttribute('brick-kind') ||\r\n      el.getAttribute('data-kind') ||\r\n      el.getAttribute('data-brick-kind') ||\r\n      (el.dataset && (el.dataset.kind || el.dataset.brickKind));\r\n    return k ? String(k).toLowerCase() : undefined;\r\n  }\r\n\r\n  function createBrickFromElement(el) {\r\n    if (!el) return null;\r\n\r\n    // Ja inicialitzat?\r\n    if (el.__brickInstance) return el.__brickInstance;\r\n\r\n    const opts = {};\r\n\r\n    const config = el.id && VanillaBrick.configs ? VanillaBrick.configs[el.id] : null;\r\n    if (config && typeof config === 'object') {\r\n      Object.assign(opts, config);\r\n    }\r\n\r\n    if (el.id) {\r\n      opts.id = el.id;\r\n    }\r\n\r\n    const kind = readKind(el);\r\n    if (kind) {\r\n      opts.kind = kind;\r\n    }\r\n\r\n    // NESTED: tot el que \u00E9s de DOM sota html.{}\n    opts.html = {\n      id: el.id || null,\n      element: el\n    };\n\r\n    const brick = new VanillaBrick.brick(opts);\r\n\r\n    el.__brickInstance = brick;\r\n    registry.list.push(brick);\r\n    registry.byId[brick.id] = brick;\r\n    console.log(\"Brick\", el.id, brick);\r\n    return brick;\r\n  }\r\n\r\n  function bootstrap(root) {\r\n    if (typeof document === 'undefined') return [];\r\n    const scope = root || document;\r\n    if (!scope.querySelectorAll) return [];\r\n\r\n    // Carrega tots els blocs de configuraci\u00F3 abans de crear bricks\r\n    loadConfigs(scope);\r\n\r\n    const nodes = scope.querySelectorAll('.vb');\r\n    const created = [];\r\n\r\n    for (let i = 0; i < nodes.length; i++) {\r\n      const brick = createBrickFromElement(nodes[i]);\r\n      if (brick) created.push(brick);\r\n    }\r\n\r\n    return created;\r\n  }\r\n\r\n  VanillaBrick.base.bootstrap = bootstrap;\r\n  VanillaBrick.runtime = VanillaBrick.runtime || {};\r\n  VanillaBrick.runtime.bricks = registry.list || [];\r\n  VanillaBrick.base.getBrick = function (id) {\r\n    return registry.byId[id] || null;\r\n  };\r\n\r\n  if (typeof document !== 'undefined') {\r\n    var bootstrapped = false;\r\n    function runOnce() {\r\n      if (bootstrapped) return;\r\n      bootstrapped = true;\r\n      bootstrap();\r\n    }\r\n\r\n    if (document.readyState === 'loading') {\r\n      document.addEventListener('DOMContentLoaded', function () {\r\n        runOnce();\r\n      });\r\n    } else {\r\n      // DOM ja llest: posposem al next tick per deixar executar scripts defer restants\r\n      setTimeout(runOnce, 0);\r\n    }\r\n  }\r\n}\r\n\r\n", "export const htmlCss = {\r\n  for: [{ host: 'brick', kind: '*' }],\r\n  requires: ['html'],\r\n  ns: 'css',\r\n  options: {},\r\n\r\n  brick: {\r\n    addClass: function (el, className) {\r\n      if (!el || !className) return;\r\n      if (el.classList && el.classList.add) {\r\n        el.classList.add(className);\r\n      } else {\r\n        const cur = el.className || '';\r\n        if ((' ' + cur + ' ').indexOf(' ' + className + ' ') === -1) {\r\n          el.className = (cur ? cur + ' ' : '') + className;\r\n        }\r\n      }\r\n    },\r\n    removeClass: function (el,className) {\r\n      if (!el || !className) return;\r\n      if (el.classList && el.classList.remove) {\r\n        el.classList.remove(className);\r\n      } else {\r\n        const cur = el.className || '';\r\n        el.className = (' ' + cur + ' ').replace(' ' + className + ' ', ' ').trim();\r\n      }\r\n    },\r\n    hasClass: function (el,className) {\r\n      if (!el || !className) return false;\r\n      if (el.classList && el.classList.contains) return el.classList.contains(className);\r\n      const cur = el.className || '';\r\n      return (' ' + cur + ' ').indexOf(' ' + className + ' ') !== -1;\r\n    },\r\n    toggleClass: function (el, className, force) {\r\n      if (!el || !className) return;\r\n      if (el.classList && typeof el.classList.toggle === 'function') {\r\n        if (typeof force === 'boolean') el.classList.toggle(className, force);\r\n        else el.classList.toggle(className);\r\n      } else {\r\n        const has = this.css.hasClass(className);\r\n        if (typeof force === 'boolean') {\r\n          if (force && !has) this.css.addClass(className);\r\n          if (!force && has) this.css.removeClass(className);\r\n        } else {\r\n          if (has) this.css.removeClass(className);\r\n          else this.css.addClass(className);\r\n        }\r\n      }\r\n    },\r\n    show: function (el) {\r\n      if (!el) return;\r\n      el.style.display = '';\r\n    },\r\n    hide: function (el) {\r\n      if (!el) return;\r\n      el.style.display = 'none';\r\n    },\r\n    setStyle: function (el,prop, value) {\r\n      if (!el || !prop) return;\r\n      el.style[prop] = value;\r\n    },\r\n    getStyle: function (el,prop) {\r\n      if (!el || !prop || typeof window === 'undefined' || !window.getComputedStyle) return null;\r\n      const cs = window.getComputedStyle(el);\r\n      return cs ? (cs.getPropertyValue(prop) || cs[prop]) : null;\r\n    },\r\n    setVar: function (el, name, value) {\r\n      if (!el || !name) return;\r\n      if (name.indexOf('--') !== 0) name = '--' + name;\r\n      el.style.setProperty(name, value);\r\n    },\r\n    getVar: function (el, name) {\r\n      if (!el || !name || typeof window === 'undefined' || !window.getComputedStyle) return null;\r\n      if (name.indexOf('--') !== 0) name = '--' + name;\r\n      const cs = window.getComputedStyle(el);\r\n      return cs ? cs.getPropertyValue(name) : null;\r\n    }\r\n  },\r\n\r\n  extension: {},\r\n  events: [],\r\n\r\n  init: function () {\r\n    if (!this.brick || !this.brick.html || typeof this.brick.html.element !== 'function') {\r\n      console.warn('VanillaBrick htmlCss requires html extension active', this.brick && this.brick.id);\r\n      return false;\r\n    }\r\n    const el = this.brick.html.element();\r\n    if (!el) {\r\n      console.warn('VanillaBrick htmlCss: no DOM element resolved', this.brick && this.brick.id);\r\n      return false;\r\n    }\r\n    return true;\r\n  },\r\n\r\n  destroy: function () { }\r\n};\r\n\r\n\r\nexport default htmlCss;\r\n\r\n", "export const htmlEvents = {\r\n  for: [{ host: 'brick', kind: '*' }],\r\n  requires: ['html'],\r\n  ns: 'html',\r\n  options: {},\r\n\r\n  brick: {\r\n    on: function (el, type, handler, options) {\r\n      if (!el || typeof el.addEventListener !== 'function' || typeof handler !== 'function') return;\r\n      el.addEventListener(type, handler, options);\r\n      let listeners = this.brick.options.get('html.listeners', []);\r\n      if (!Array.isArray(listeners)) listeners = [];\r\n      listeners.push({ el: el, type: type, handler: handler, options: options, source: 'api' });\r\n      this.brick.options.setSilent('html.listeners', listeners);\r\n    },\r\n    off: function (el, type, handler) {\r\n      if (!el || typeof el.removeEventListener !== \"function\") return;\r\n\r\n      const listeners = this.brick.options.get(\"html.listeners\", []);\r\n      if (!Array.isArray(listeners) || listeners.length === 0) return;\r\n\r\n      const hasType = typeof type === \"string\" && type.length > 0;\r\n      const hasHandler = typeof handler === \"function\";\r\n\r\n      for (let i = listeners.length - 1; i >= 0; i--) {\r\n        const ln = listeners[i];\r\n        if (!ln || ln.el !== el) continue;\r\n        if (hasType && ln.type !== type) continue;\r\n        if (hasHandler && ln.handler !== handler) continue;\r\n\r\n        // IMPORTANT: treu amb els options originals, no els que et passin ara\r\n        el.removeEventListener(ln.type, ln.handler, ln.options);\r\n        listeners.splice(i, 1);\r\n      }\r\n\r\n      this.brick.options.setSilent(\"html.listeners\", listeners);\r\n    }\r\n  },\r\n\r\n  extension: {},\r\n\r\n  events: [\r\n    {\r\n      for: 'brick:status:ready',\r\n      on: {\r\n        fn: function () {\r\n          const el = this.brick.html.element();\r\n          if (!el || typeof el.addEventListener !== 'function') return;\r\n          let listeners = this.brick.options.get(\"html.events.listeners\", []);\r\n          if (!Array.isArray(listeners)) listeners = [];\r\n          const self = this;\r\n          const defaultMap = [\r\n            { type: 'click', eventName: 'html:event:click' },\r\n            { type: 'mouseenter', eventName: 'html:event:mouseenter' },\r\n            { type: 'mouseleave', eventName: 'html:event:mouseleave' },\r\n            { type: 'mousedown', eventName: 'html:event:mousedown' },\r\n            { type: 'mouseup', eventName: 'html:event:mouseup' },\r\n          ];\r\n\r\n          for (let i = 0; i < defaultMap.length; i += 1) {\r\n            const entry = defaultMap[i];\r\n            const handler = function handler(domEvent) {\r\n              self.brick.events.fire(entry.eventName, {\r\n                domEvent: domEvent,\r\n                element: el,\r\n              });\r\n            };\r\n            this.brick.html.on(el,entry.type,handler);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    {\r\n      for: 'brick:status:destroyed',\r\n      before: {\r\n        fn: function () {\r\n          const el = this.brick && this.brick.html.element && this.brick.html.element();\r\n          if (!el || typeof el.removeEventListener !== 'function') return;\r\n          const listeners = this.brick.options.get(\"html.events.listeners\", []);\r\n          if (!Array.isArray(listeners)) return;\r\n          for (let i = 0; i < listeners.length; i += 1) {\r\n            const ln = listeners[i];\r\n            this.brick.html.off(el,ln.type,ln.handler,ln.options);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  ],\r\n\r\n  init: function () { },\r\n  destroy: function () { }\r\n};\r\n\r\n\r\nexport default htmlEvents;\r\n\r\n", "export const htmlRender = {\n  for: [{ host: 'brick', kind: '*' }],\n  requires: ['html'],\n  ns: 'html',\n  options: {},\n\n  brick: {\n    attr: function (el, key, value) {\n      if (!el) return el;\n\n      // Permet passar objecte: attr(el, { id:\"x\", title:\"y\" })\n      if (key && typeof key === \"object\") {\n        for (const k in key) attr(el, k, key[k]);\n        return el;\n      }\n\n      if (value === undefined || value === null || value === false) {\n        el.removeAttribute(key);\n        return el;\n      }\n\n      // boolean attribute (checked, disabled, readonly, etc.)\n      if (value === true) {\n        el.setAttribute(key, \"\");\n        return el;\n      }\n\n      el.setAttribute(key, String(value));\n      return el;\n    },\n    // Safe getters/creators\n    get: function (selectorOrTag) {\n      if (!selectorOrTag) return null;\n      const root = this.html && typeof this.html.element === 'function' ? this.html.element() : null;\n      if (!root || !root.querySelector) return null;\n      // If it's a tag name and root matches, return root\n      if (selectorOrTag.toLowerCase && root.tagName && selectorOrTag.toLowerCase() === root.tagName.toLowerCase()) {\n        return root;\n      }\n      return root.querySelector(selectorOrTag) || null;\n    },\n    create: function (tag, props) {\n      if (!tag || typeof document === 'undefined') return null;\n      const el = document.createElement(tag);\n      const cfg = props || {};\n      if (cfg.text !== undefined && cfg.text !== null) {\n        el.textContent = cfg.text;\n      }\n      if (cfg.html !== undefined && cfg.html !== null && this.html && typeof this.html.sanitize === 'function') {\n        el.innerHTML = this.html.sanitize(String(cfg.html));\n      }\n      if (cfg.attrs && typeof cfg.attrs === 'object') {\n        for (const k in cfg.attrs) {\n          if (Object.prototype.hasOwnProperty.call(cfg.attrs, k) && cfg.attrs[k] !== undefined) {\n            el.setAttribute(k, cfg.attrs[k]);\n          }\n        }\n      }\n      if (cfg.classList && Array.isArray(cfg.classList)) {\n        el.classList.add.apply(el.classList, cfg.classList);\n      }\n      if (cfg.dataset && typeof cfg.dataset === 'object') {\n        for (const k in cfg.dataset) {\n          if (Object.prototype.hasOwnProperty.call(cfg.dataset, k) && cfg.dataset[k] !== undefined) {\n            el.dataset[k] = cfg.dataset[k];\n          }\n        }\n      }\n      return el;\n    },\n    frag: function () {\n      return (typeof document !== 'undefined' && document.createDocumentFragment) ? document.createDocumentFragment() : null;\n    },\n    append: function (target, nodeOrFrag) {\n      if (!target || !nodeOrFrag || !target.appendChild) return;\n      target.appendChild(nodeOrFrag);\n    },\n    prepend: function (target, nodeOrFrag) {\n      if (!target || !nodeOrFrag || !target.insertBefore) return;\n      if (!target.firstChild) {\n        target.appendChild(nodeOrFrag);\n      } else {\n        target.insertBefore(nodeOrFrag, target.firstChild);\n      }\n    },\n    replace: function (target, nodeOrFrag) {\n      if (!target || !target.replaceChildren) return;\n      target.replaceChildren(nodeOrFrag);\n    },\n    clear: function (target) {\n      if (!target || !target.replaceChildren) return;\n      target.replaceChildren();\n    },\n    detach: function (el) {\n      if (!el) return el || null;\n      if (el.parentNode) {\n        el.parentNode.removeChild(el);\n      }\n      return el;\n    },\n    setSafe: function (el, htmlString) {\n      if (!el) return;\n      if (!htmlString) {\n        el.innerHTML = '';\n        return;\n      }\n      if (this.html && typeof this.html.sanitize === 'function') {\n        el.innerHTML = this.html.sanitize(String(htmlString));\n      } else {\n        el.textContent = String(htmlString);\n      }\n    },\n    sanitize: function (htmlString) {\n      if (!htmlString) return '';\n      // Simple sanitizer: strip scripts/inline handlers/javascript: URLs\n      if (typeof DOMParser === 'undefined') {\n        return String(htmlString).replace(/<script[\\s\\S]*?>[\\s\\S]*?<\\/script>/gi, '');\n      }\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(String(htmlString), 'text/html');\n      const scripts = doc.querySelectorAll('script, style, iframe, object, embed');\n      scripts.forEach(function (node) { if (node && node.parentNode) node.parentNode.removeChild(node); });\n      const walker = doc.createTreeWalker(doc.body, NodeFilter.SHOW_ELEMENT, null);\n      while (walker.nextNode()) {\n        const node = walker.currentNode;\n        // Remove inline event handlers\n        const attrs = Array.prototype.slice.call(node.attributes || []);\n        for (let i = 0; i < attrs.length; i++) {\n          const a = attrs[i];\n          const name = a.name.toLowerCase();\n          const val = a.value || '';\n          if (name.startsWith('on')) {\n            node.removeAttribute(a.name);\n            continue;\n          }\n          if ((name === 'href' || name === 'src') && /^javascript:/i.test(val)) {\n            node.removeAttribute(a.name);\n          }\n        }\n      }\n      return doc.body.innerHTML || '';\n    },\n    // Render helpers\n    queueRender: function (fn) {\n      if (typeof fn !== 'function') return;\n      if (typeof requestAnimationFrame === 'function') {\n        requestAnimationFrame(fn);\n      } else {\n        setTimeout(fn, 0);\n      }\n    },\n    batch: function (items, chunkSize, renderChunk) {\n      const arr = Array.isArray(items) ? items : [];\n      const size = typeof chunkSize === 'number' && chunkSize > 0 ? chunkSize : 100;\n      const render = typeof renderChunk === 'function' ? renderChunk : null;\n      if (!render) return Promise.resolve();\n      let index = 0;\n      return new Promise((resolve) => {\n        const step = () => {\n          const slice = arr.slice(index, index + size);\n          if (slice.length) {\n            render(slice, index);\n            index += size;\n            this.queueRender(step.bind(this));\n          } else {\n            resolve();\n          }\n        };\n        step();\n      });\n    }\n  },\n\n  extension: {},\n  events: [],\n  init: function () { return true; },\n  destroy: function () { }\n};\n\nexport default htmlRender;\n", "export const html = {\n  for: [{ host: 'brick', kind: '*' }],\n  requires: [],\n  ns: 'html',\n  options: {},\n\r\n  brick: {\r\n    element: function () {\r\n      return this.options.get('html.element', null);\n    },\r\n    on: function (type, handler, options) {\r\n      const el = this.options.get('html.element', null);\n      if (!el || typeof el.addEventListener !== 'function' || typeof handler !== 'function') return;\r\n      el.addEventListener(type, handler, options);\r\n      let listeners = this.options.get('html.listeners', []);\n      if (!Array.isArray(listeners)) listeners = [];\r\n      listeners.push({ type: type, handler: handler, options: options, source: 'api' });\r\n      this.options.setSilent('html.listeners', listeners);\n    },\r\n    off: function (type, handler, options) {\r\n      const el = this.options.get('html.element', null);\n      if (!el || typeof el.removeEventListener !== 'function' || typeof handler !== 'function') return;\r\n      el.removeEventListener(type, handler, options);\r\n      const listeners = this.options.get('html.listeners', []);\n      if (!Array.isArray(listeners)) return;\r\n      for (let i = listeners.length - 1; i >= 0; i -= 1) {\r\n        const ln = listeners[i];\r\n        if (ln.type === type && ln.handler === handler) {\r\n          listeners.splice(i, 1);\r\n        }\r\n      }\r\n      this.options.setSilent('html.listeners', listeners);\n    }\n  },\n\r\n  extension: {\r\n    _resolveElement: function (value) {\r\n      if (!value) return null;\r\n      if (typeof Element !== 'undefined' && value instanceof Element) return value;\r\n      if (value && value.nodeType === 1) return value;\r\n      if (typeof value === 'function') {\r\n        try {\r\n          return value();\r\n        } catch (err) {\r\n          return null;\r\n        }\r\n      }\r\n      return null;\r\n    },\r\n    _resolveById: function (id) {\r\n      if (!id || typeof id !== 'string') return null;\r\n      if (typeof document === 'undefined') return null;\r\n      return document.getElementById(id) || null;\r\n    }\r\n  },\r\n\r\n  events: [],\r\n\r\n  init: function () {\r\n    if (!this.brick) return false;\r\n    const elemOpt = this.brick.options.get('html.element', null);\n    const idOpt = this.brick.options.get('html.id', null);\n\r\n    let el = this._resolveElement(elemOpt);\r\n    if (!el && idOpt) {\r\n      el = this._resolveById(idOpt);\r\n    }\r\n\r\n    if (!el) {\r\n      console.warn('VanillaBrick html extension requires a DOM element (options.html.element) or a valid options.html.id', this.brick.id);\n      return false;\n    }\n\n    if (elemOpt && !this._resolveElement(elemOpt)) {\n      console.warn('VanillaBrick html element must be a DOM node or factory, not an id. Use options.html.id to resolve by id.', this.brick.id);\n    }\n\n    this.brick.options.set('html.element', el);\n    return true;\n  },\n\n  destroy: function () {\n    const el = this.brick.options.get('html.element', null);\n    const listeners = this.brick.options.get('html.listeners', null);;\n    if (el && Array.isArray(listeners)) {\r\n      for (let i = 0; i < listeners.length; i += 1) {\r\n        const ln = listeners[i];\r\n        if (ln && ln.type && ln.handler) {\r\n          el.removeEventListener(ln.type, ln.handler, ln.options);\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n\r\nexport default html;\n\r\n", "const DATA_SAMPLE_ROWS = [\r\n  { code: '1', name: 'one', key: 1 },\r\n  { code: '2', name: 'two', key: 2 },\r\n  { code: '3', name: 'three', key: 3 },\r\n  { code: '4', name: 'four', key: 4 },\r\n  { code: '5', name: 'five', key: 5 },\r\n  { code: '6', name: 'six', key: 6 },\r\n  { code: '7', name: 'seven', key: 7 },\r\n  { code: '8', name: 'eight', key: 8 },\r\n  { code: '9', name: 'nine', key: 9 },\r\n  { code: '10', name: 'ten', key: 10 },\r\n  { code: '11', name: 'eleven', key: 11 },\r\n  { code: '12', name: 'twelve', key: 12 },\r\n  { code: '13', name: 'thirteen', key: 13 },\r\n  { code: '14', name: 'fourteen', key: 14 },\r\n  { code: '15', name: 'fifteen', key: 15 },\r\n  { code: '16', name: 'sixteen', key: 16 },\r\n  { code: '17', name: 'seventeen', key: 17 },\r\n  { code: '18', name: 'eighteen', key: 18 },\r\n  { code: '19', name: 'nineteen', key: 19 },\r\n  { code: '20', name: 'twenty', key: 20 },\r\n];\r\n\r\nexport const store = {\n  for: [\n    { host: 'brick', kind: 'form' },\n    { host: 'brick', kind: 'table' }\n  ],\n  requires: [],\r\n  ns: 'store',\r\n  options: {},\r\n\r\n  // API p\u00FAblica sobre el brick (this === brick)\r\n  brick: {\r\n    load: function () {\r\n      return this.brick.options.get('store.data', []);\r\n    },\r\n    set: function (data) {\r\n      if (data === null) return;\r\n      const previous = this.brick.options.get('store.data', []);\r\n      data = Array.isArray(data) ? data.slice() : [data];\r\n\r\n      this.brick.events.fire('store:data:set', {\r\n        previous: previous,\r\n        data: data\r\n      });\r\n\r\n      return data;\r\n    },\r\n    setAsync: async function (data) {\r\n      const previous = this.brick.options.get('store.data', []);\r\n      data = Array.isArray(data) ? data.slice() : [];\r\n\r\n      await this.brick.events.fireAsync('store:data:set', {\r\n        previous: previous,\r\n        data: data\r\n      });\r\n\r\n      return data;\r\n    },\r\n    all: function () {\r\n      return this.brick.store.load();\r\n    },\r\n    get: function (index) {\r\n      const arr = this.brick.store.load();\r\n      if (typeof index !== 'number') return null;\r\n      if (index < 0 || index >= arr.length) return null;\r\n      return arr[index];\r\n    }\r\n  },\r\n\r\n  // Helpers interns (this === ext)\r\n  extension: {\r\n    _normalizeArray: function (value, fallback) {\r\n      if (Array.isArray(value)) return value.slice();\r\n      return Array.isArray(fallback) ? fallback.slice() : [];\r\n    },\r\n    _sortRows: function (rows, field, dir, compareFn) {\r\n      const arr = Array.isArray(rows) ? rows.slice() : [];\r\n      const cmp = typeof compareFn === 'function'\r\n        ? function (a, b) { return compareFn(a, b, dir); }\r\n        : function (a, b) {\r\n          const va = a && Object.prototype.hasOwnProperty.call(a, field) ? a[field] : undefined;\r\n          const vb = b && Object.prototype.hasOwnProperty.call(b, field) ? b[field] : undefined;\r\n          let res = 0;\r\n          if (va === vb) res = 0;\r\n          else if (va === undefined || va === null) res = -1;\r\n          else if (vb === undefined || vb === null) res = 1;\r\n          else if (typeof va === 'number' && typeof vb === 'number') res = va - vb;\r\n          else res = String(va).localeCompare(String(vb));\r\n          return dir === 'desc' ? -res : res;\r\n        };\r\n      arr.sort(cmp);\r\n      return arr;\r\n    }\r\n  },\r\n\r\n  events: [\r\n    {\r\n      for: 'brick:status:ready',\r\n      on: {\r\n        fn: function (ev) {\r\n          //const storeData = this.brick.options.get('store:data', null);\r\n          const storeData = this._normalizeArray(DATA_SAMPLE_ROWS, []);\r\n          this.brick.options.setSilent('store.data', storeData);\r\n        }\r\n      }\r\n    },\r\n    {\r\n      for: 'store:data:set',\r\n      on: {\r\n        fn: function (ev) {\r\n          const payload = (ev && ev.data) || null;\r\n          const data = payload && payload.data ? payload.data : [];\r\n          this.brick.options.setSilent('store.data', data);\r\n        }\r\n      }\r\n    },\r\n    {\r\n      for: 'store:data:sort',\r\n      on: {\r\n        fn: function (ev) {\r\n          const payload = (ev && ev.data) || {};\r\n\r\n          const field = payload.field || null;\r\n          const dir = payload.dir || 'asc';\r\n\r\n          if (!field || !this.brick) return;\r\n          const sorted = this._sortRows(this.brick.store.load(), field, dir, payload.compare);\r\n          this.brick.options.setSilent(\"store.data\", sorted);\r\n          ev.field = field;\r\n          ev.dir = dir;\r\n          ev.data = sorted;\r\n        }\r\n      }\r\n    }\r\n  ],\r\n\r\n  init: function () { },\r\n\r\n  destroy: function () { }\r\n};\r\n\r\n\r\nexport default store;\r\n\r\n", "export const wire = {\r\n    for: [{ host: 'brick', kind: '*' }], // Available to all bricks\r\n    requires: [], // No strict requirements\r\n    ns: 'wire',\r\n    options: {},\r\n\r\n    brick: {\r\n        notify: function (eventName, data) {\r\n            //console.warn(\"WireClient > sending notify\", eventName, data);\r\n            //console.log(\"\\tfor event\", eventName);\r\n            //console.log(\"\\twith payload\", data);\r\n            if (!this.ext._service) this.ext._connect();\r\n            if (!this.ext._service) return; // Still no service?\r\n            this.ext._service.events.fire('wire:notify:out', {\r\n                from: this.brick.id,\r\n                event: eventName,\r\n                data: data\r\n            });\r\n        },\r\n        request: function (eventName, data) {\r\n            //console.warn(\"request\", eventName, data);\r\n            //console.log(\"this\", this);\r\n            if (!this.ext._service) this.ext._connect();\r\n            if (!this.ext._service) return; // Still no service?\r\n            //console.log(\"this.service\", this.ext._service);\r\n            this.ext._service.events.fire('wire:request:out', {\r\n                from: this.brick.id,\r\n                event: eventName,\r\n                data: data\r\n            });\r\n        },\r\n    },\r\n\r\n    extension: {\r\n        _service: null,\r\n\r\n        _connect: function () {\r\n\r\n            if (this.ext._service) return;\r\n\r\n            let wireKind = this.brick.options.get(\"wire\", null);\r\n            if (wireKind == null) return;\r\n\r\n            // Connect to WireService\r\n            if (globalThis.VanillaBrick && globalThis.VanillaBrick.service) {\r\n                this.ext._service = globalThis.VanillaBrick.service('WireService');\r\n            }\r\n\r\n            if (this.ext._service) {\r\n                this.ext._service.events.fire('wire:register:in', {\r\n                    brick: this.brick,\r\n                    options: this.brick.options.get(\"wire\", {})\r\n                });\r\n            } else {\r\n                console.warn('[Wire Client] No Wire Service found.', this.ext._service);\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    events: [\r\n        {\r\n            for: 'brick:status:ready',\r\n            on: {\r\n                fn: function () {\r\n                    this._connect();\r\n                }\r\n            }\r\n        },\r\n    ],\r\n\r\n    init: function () { },\r\n\r\n    destroy: function () { }\r\n};\r\n\r\n\r\nexport default wire;\r\n\r\n", "export const wireservice = {\r\n    for: [{ host: 'service', kind: 'wire' }], // Available to all bricks\r\n    requires: [], // No strict requirements\r\n    ns: 'wire',\r\n    options: {},\r\n\r\n    brick: {},\r\n    events: [\r\n        {\r\n            for: 'wire:notify:out',\r\n            on: {\r\n                fn: function (ev) {\r\n                    //console.warn(\"WireService > on wire:notify:out\", ev);\r\n\r\n                    const master = ev.data.from;\r\n                    //console.log(\"\\tfrom\", master);\r\n                    const evName = ev.data.event;\r\n                    //console.log(\"\\tevName\", evName);\r\n                    const evData = ev.data.data;\r\n                    //console.log(\"\\tevData\", evData);\r\n                    const slaves = this.ext._slaves[master];\r\n                    //console.log(\"\\tfor slaves\", slaves);\r\n                    if (slaves && slaves.length > 0) {\r\n                        for (let i = 0; i < slaves.length; i++) {\r\n                            //console.log(\"\\t- firing\", evName, \"in\", slaves[i].brick.id);\r\n                            slaves[i].brick.events.fire(evName, evData);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        {\r\n            for: 'wire:register:in',\r\n            on: {\r\n                fn: function (ev) {\r\n                    this.ext._register(ev.data);\r\n                }\r\n            }\r\n        },\r\n    ],\r\n    extension: {\r\n        _register: function (data) {\r\n            //console.warn(\"register\", data.brick, data.options, this);\r\n            if (data.options.master) {\r\n                if (this.ext._bricks == null) this.ext._bricks = {};\r\n                this.ext._bricks[data.brick.id] = data.brick;\r\n            }\r\n            if (data.options.slaveOf && data.options.slaveOf.length > 0) {\r\n                if (this.ext._masters == null) this.ext._masters = {};\r\n                if (this.ext._slaves == null) this.ext._slaves = {};\r\n                for (let i = 0; i < data.options.slaveOf.length; i++) {\r\n                    let master = this.ext._masters[data.brick.id];\r\n                    if (!master) {\r\n                        this.ext._masters[data.brick.id] = [];\r\n                    }\r\n                    this.ext._masters[data.brick.id].push({ id: data.options.slaveOf[i].id, kind: data.options.slaveOf[i].kind });\r\n\r\n                    let slave = this.ext._slaves[data.options.slaveOf[i].id];\r\n                    if (!slave) {\r\n                        this.ext._slaves[data.options.slaveOf[i].id] = [];\r\n                    }\r\n                    this.ext._slaves[data.options.slaveOf[i].id].push({ id: data.brick.id, kind: data.brick.kind, brick: data.brick });\r\n                }\r\n\r\n            }\r\n            //console.log(\"_bricks\", this.ext._bricks);\r\n            //console.log(\"_masters\", this.ext._masters);\r\n            //console.log(\"_slaves\", this.ext._slaves);\r\n        },\r\n    }\r\n}\r\n\r\n\r\nexport default wireservice;\r\n\r\n", "export const formItems = {\r\n    for: [{ host: 'brick', kind: 'form' }],\r\n    requires: ['html'],\n    ns: 'items',\r\n    options: {},\r\n\r\n    brick: {\r\n        get: function () {\r\n            return this.options.get('form.items', []);\r\n        }\r\n    },\r\n\r\n    extension: {\r\n        _parseFromDom: function () {\r\n            const root = this.brick.html.element();\n            if (!root) return [];\r\n\r\n            const items = [];\r\n            const groups = root.querySelectorAll('.vb-form-group');\r\n\r\n            for (let i = 0; i < groups.length; i++) {\r\n                const groupEl = groups[i];\r\n                const group = {\r\n                    type: 'group',\r\n                    items: []\r\n                };\r\n\r\n                // Check structure inside group\r\n                const fields = groupEl.querySelectorAll('.vb-form-field');\r\n                for (let j = 0; j < fields.length; j++) {\r\n                    const fieldEl = fields[j];\r\n                    const input = fieldEl.querySelector('input, select, textarea');\r\n                    const label = fieldEl.querySelector('label');\r\n\r\n                    if (input) {\r\n                        const fieldItem = {\r\n                            type: 'field',\r\n                            name: input.name || input.id,\r\n                            label: label ? label.textContent : '',\r\n                            controlType: input.tagName.toLowerCase(),\r\n                            inputType: input.type,\r\n                            required: input.required,\r\n                            placeholder: input.placeholder,\r\n                            // Detect span from parent column if exists\r\n                            span: this._detectSpan(fieldEl)\r\n                        };\r\n                        group.items.push(fieldItem);\r\n                    }\r\n                }\r\n                items.push(group);\r\n            }\r\n            return items;\r\n        },\r\n\r\n        _detectSpan: function (el) {\r\n            let current = el;\r\n            while (current && !current.classList.contains('vb-row')) {\r\n                if (current.className && typeof current.className === 'string') {\r\n                    const match = current.className.match(/vb-span-(\\d+)/);\r\n                    if (match) return parseInt(match[1], 10);\r\n                }\r\n                current = current.parentElement;\r\n                if (!current || current.tagName === 'FORM') break;\r\n            }\r\n            return 12; // Default full width\r\n        },\r\n\r\n        _render: function (items) {\n            const html = this.brick.html;\n            const root = html.element();\n            if (!root) return;\n\n            // Always clear existing content when rendering from items list\n            html.clear(root);\n\n            const frag = html.frag() || root.ownerDocument.createDocumentFragment();\n\n            for (let i = 0; i < items.length; i++) {\n                const item = items[i];\n                if (item.type !== 'group') continue;\n\n                const groupEl = html.create('div', { classList: ['vb-form-group'] });\n\n                const rowEl = html.create('div', { classList: ['vb-row'] });\n\n                if (item.items && item.items.length) {\n                    for (let j = 0; j < item.items.length; j++) {\n                        const field = item.items[j];\n                        const span = field.span || 12;\n                        const colEl = html.create('div', { classList: ['vb-span-' + span] });\n\n                        const fieldContainer = html.create('div', { classList: ['vb-form-field'] });\n\n                        if (field.label) {\n                            const label = html.create('label', { text: field.label });\n                            if (field.name) label.htmlFor = field.name;\n                            html.append(fieldContainer, label);\n                        }\n\n                        let input;\n                        if (field.controlType === 'textarea') {\n                            input = html.create('textarea');\n                        } else if (field.controlType === 'select') {\n                            input = html.create('select');\n                            // TODO: options\n                        } else {\n                            input = html.create('input');\n                            input.type = field.inputType || 'text';\n                        }\n\n                        if (field.name) {\n                            input.name = field.name;\n                            input.id = field.name;\r\n                        }\r\n                        if (field.placeholder) input.placeholder = field.placeholder;\r\n                        // handle required gracefully\r\n                        if (field.required === true || field.required === 'true' || field.required === 'required') {\r\n                            input.required = true;\n                        }\n\n                        html.append(fieldContainer, input);\n                        html.append(colEl, fieldContainer);\n                        html.append(rowEl, colEl);\n                    }\n                }\n\n                html.append(groupEl, rowEl);\n                html.append(frag, groupEl);\n            }\n\n            html.append(root, frag);\n\n            // Add Actions container if needed (can be separate config)\n        }\n    },\n\r\n    events: [\r\n        {\r\n            for: 'brick:status:ready',\r\n            before: {\r\n                fn: function (ev) {\r\n                    // Start fresh\r\n                    let items = [];\r\n                    // Check options first (programmatic)\r\n                    if (this.brick.options.has('form.items')) {\r\n                        items = this.brick.options.get('form.items');\r\n                    }\r\n\r\n                    if (!items || items.length === 0) {\r\n                        // Try to parse from global variable defined in attribute\r\n                        const root = this.brick.html.element();\n                        if (root) {\r\n                            const configVar = root.getAttribute('brick-form-items') || root.getAttribute('data-form-items');\r\n                            if (configVar && window[configVar]) {\r\n                                console.log('[Form Items] Config var found', configVar);\r\n                                items = window[configVar];\r\n                                this.brick.options.set('form.items', items);\r\n                            }\r\n                        }\r\n\r\n                        // if still no items, check if current DOM has any specific structure to parse\r\n                        // (only if we didn't just load them from var)\r\n                        if (!items || items.length === 0) {\r\n                            // Try to parse from DOM\r\n                            console.log('[Form Items] Parsing from DOM', this.brick.id);\r\n                            items = this._parseFromDom();\r\n                            this.brick.options.set('form.items', items);\r\n                        }\r\n                    } else {\r\n                        console.log('[Form Items] Config found in options', items);\r\n                    }\r\n\r\n                    // Helper to access data in on phase\r\n                    ev.data = ev.data || {};\r\n                    ev.data.formItems = items;\r\n                }\r\n            },\r\n            on: {\r\n                fn: function (ev) {\r\n                    const items = ev.data.formItems || this.brick.options.get('form.items');\r\n\r\n                    if (items && items.length > 0) {\r\n                        // We render if there are items. \r\n                        // Note: If we just parsed them from DOM, this will clear and re-render the same structure.\r\n                        // Ideally we check if we need to render.\r\n                        // But per requirements: \"Si li pasem un arbre d'items... tant \u00E9s el que hi hagi en el html/DOM. Ha d'haver-hi aquells. Si cal netejar el DOM i afegir els nous... es fa.\"\r\n\r\n                        // Optimization: if we just parsed it, re-rendering is redundant but safe. \r\n                        // To avoid infinite loop or weirdness, we could check a flag, but strict rendering ensures state == DOM.\r\n                        this._render(items);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    ],\r\n\r\n    init: function () {\r\n        return true;\r\n    },\r\n\r\n    destroy: function () {\r\n    }\r\n};\r\n\r\n\r\nexport default formItems;\r\n\r\n", "export const formRecord = {\r\n    for: [{ host: 'brick', kind: 'form' }],\r\n    requires: ['html', 'store'],\r\n    ns: 'record',\r\n    options: {},\r\n\r\n    brick: {\r\n        // We could expose methods to get/set the current record directly if needed\r\n        getRecord: function () {\r\n            const data = this.store.load();\r\n            return (data && data.length) ? data[0] : null;\r\n        }\r\n    },\r\n\r\n    extension: {\r\n        _bind: function (record) {\r\n            const root = this.brick.html.element();\r\n            if (!root) return;\r\n\r\n            // Iterate over all form fields\r\n            const inputs = root.querySelectorAll('input, select, textarea');\r\n            for (let i = 0; i < inputs.length; i++) {\r\n                const input = inputs[i];\r\n                const name = input.name || input.id;\r\n                if (!name) continue;\r\n\r\n                // If record has this field, set value\r\n                if (record && Object.prototype.hasOwnProperty.call(record, name)) {\r\n                    input.value = record[name];\r\n                } else {\r\n                    // Optional: clear if not in record? Or leave defaults?\r\n                    // Typically binding means reflecting state. If state is null, clear.\r\n                    // But if record doesn't have the key, maybe leave it?\r\n                    // Let's assume strict binding for now: if record is null, clear.\r\n                    if (!record) input.value = '';\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    events: [\r\n        {\r\n            for: 'brick:status:ready',\r\n            on: {\r\n                fn: function (ev) {\r\n                    const data = this.brick.store.load();\r\n                    if (data && data.length) {\r\n                        this._bind(data[0]);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        {\r\n            for: 'store:data:*',\r\n            after: {\r\n                fn: function (ev) {\r\n                    const data = this.brick.store.load();\r\n                    // We bind the first record\r\n                    const record = (data && data.length) ? data[0] : null;\r\n                    this._bind(record);\r\n                }\r\n            }\r\n        },\r\n        {\r\n            for: 'dom:row:focus',\r\n            after: {\r\n                fn: function (ev) {\r\n                    //console.warn(\"Form > master focused a row\", ev);\r\n                    const record = ev.data.row;\r\n                    //console.log(\"\\trecord\", record);\r\n                    // We bind the first record\r\n                    this._bind(record);\r\n                }\r\n            }\r\n        }\r\n    ],\r\n\r\n    init: function () {\r\n        return true;\r\n    },\r\n\r\n    destroy: function () {\r\n    }\r\n};\r\n\r\n\r\nexport default formRecord;\r\n\r\n", "export const form = {\r\n    for: [{ host: 'brick', kind: 'form' }],\r\n    requires: ['html'],\n    ns: 'form',\r\n    options: {\r\n        items:[],\r\n    },\r\n\r\n    brick: {\r\n        // Basic form component methods can be added here\r\n        submit: function () {\r\n            // Placeholder for submit logic\r\n            const el = this.dom.element();\r\n            if (el && typeof el.submit === 'function') el.submit();\r\n        },\r\n        reset: function () {\r\n            const el = this.dom.element();\r\n            if (el && typeof el.reset === 'function') el.reset();\r\n        }\r\n    },\r\n\r\n    extension: {\r\n        // Internal extension logic\r\n    },\r\n\r\n    events: [\r\n        // Basic lifecycle events\r\n        {\r\n            for: 'brick:status:ready',\r\n            on: {\r\n                fn: function () {\r\n                    // Initialization logic\r\n                }\r\n            }\r\n        }\r\n    ],\r\n\r\n    init: function () {\r\n        return true;\r\n    },\r\n\r\n    destroy: function () {\r\n    }\r\n};\r\n\r\n\r\nexport default form;\r\n\r\n", "export const statusBar = {\r\n    for: [{ host: 'brick', kind: 'status-bar' }],\r\n    requires: ['html'],\n    ns: 'statusBar',\r\n    events: [\r\n        {\r\n            for: 'dom:row:focus',\r\n            after: {\r\n                fn: function (ev) {\r\n                    const record = ev.data.row;\r\n                    const el = this.brick.html.element();\n                    if (el) {\r\n                        el.textContent = `Wire OK -> Selected: ${record.name}`;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    ],\r\n    init: function () {\n        const el = this.brick.html.element();\n        if (el) el.textContent = 'Wire status: Waiting for table...';\n    }\n};\n\nexport default statusBar;\n", "export const tableColumns = {\n  for: [{ host: 'brick', kind: 'table' }],\n  requires: ['html', 'store'],\n  ns: 'columns',\n\n  brick: {\n    get: function () {\n      return this.options.get(\"table.columns\", []);\n    },\n    sort: function (field, dir) {\n      const cols = this.brick.columns.get();\n      const colDef = cols.find(function (c) { return c && c.datafield === field; }) || {};\n      const state = this.options.get(\"table.sort\", { field: null, dir: null });\n      let nextDir = dir;\n      if (nextDir !== 'asc' && nextDir !== 'desc') {\n        nextDir = (state.field === field && state.dir === 'asc') ? 'desc' : 'asc';\n      }\n\n      this.events.fire('store:data:sort', {\n        field: field,\n        dir: nextDir,\n        compare: typeof colDef.sort === 'function' ? colDef.sort : null\n      });\n\n      return nextDir;\n    }\n  },\n\n  extension: {},\n\n  events: [\n    {\n      for: 'brick:status:ready',\n      on: {\n        fn: function (ev) {\n          const columns = this.brick.columns.get();\n          const html = this.brick.html;\n          const root = html.element && html.element();\n          if (!root) return;\n\n          const table = root.tagName && root.tagName.toLowerCase() === 'table'\n            ? root\n            : (html.get && html.get('table')) || (root.querySelector && root.querySelector('table'));\n          if (!table) return;\n\n          // Build thead in-memory; attach in 'after'\n          const thead = html.create('thead');\n          const row = thead.insertRow();\n          const brick = this.brick;\n\n          for (let i = 0; i < columns.length; i += 1) {\n            const col = columns[i] || {};\n            const th = html.create('th', { text: col.label || col.datafield || '' });\n            if (col.sortable && col.datafield) {\n              th.classList.add('vb-sortable');\n              html.on(th, 'click', (function (colDef) {\n                return function () {\n                  brick.columns.sort(colDef.datafield, null);\n                };\n              })(col));\n            }\n            html.append(row, th);\n          }\n\n          // Pass along to after phase\n          if (!ev.data) ev.data = {};\n          ev.data.table = table;\n          ev.data.thead = thead;\n        }\n      },\n      after: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          const table = (ev && ev.data && ev.data.table) || (html.get && html.get('table')) || null;\n          const thead = ev && ev.data && ev.data.thead;\n          if (!table || !thead) return;\n\n          const existing = table.tHead || table.querySelector && table.querySelector('thead');\n          if (existing && existing !== thead && existing.parentNode === table) {\n            table.removeChild(existing);\n          }\n          table.insertBefore(thead, table.firstChild || null);\n        }\n      }\n    },\n    {\n      for: 'store:data:sort',\n      after: {\n        fn: function (ev) {\n          this.brick.options.setSilent(\"table.sort\", { field: ev.field, dir: ev.dir || 'asc' });\n        }\n      }\n    }\n  ],\n\n  init: function () { },\n\n  destroy: function () { },\n\n  options: {\n    table: {\n      columns: [\n        { datafield: 'code', label: 'Code', sortable: true },\n        { datafield: 'name', label: 'Name', sortable: true },\n        { datafield: 'key', label: 'Key', sortable: false },\n      ]\n    }\n  }\n};\n\n\n\nexport default tableColumns;\n\n", "export const tableRowsFocused = {\r\n    for: [{ host: 'brick', kind: 'table' }],\r\n    requires: ['html', 'rows', 'store'],\r\n    ns: 'rowsFocused',\r\n    options: {},\r\n\r\n    brick: {},\r\n\r\n    extension: {\r\n       /* _addTabIndex: function () {\r\n            const el = this.brick.html.element();\r\n            if (!el) return;\r\n            const rows = el.querySelectorAll('tbody tr') || [];\r\n            for (let i = 0; i < rows.length; i++) {\r\n                const row = rows[i];\r\n                if (!row.hasAttribute('tabindex')) {\r\n                    row.setAttribute('tabindex', i);\r\n                }\r\n            }\r\n        },\r\n        _handleFocus: function (target) {\r\n            const el = this.brick.html.element();\r\n            if (!el) return;\r\n            const row = target.closest('tr');\r\n            if (!row) return;\r\n            const old = el.querySelector('tr.vb-focused');\r\n            if (old) old.classList.remove('vb-focused');\r\n            row.classList.add('vb-focused');\r\n            const rowIndex = Array.prototype.indexOf.call(row.parentNode.children, row);\r\n            const data = this.brick.store.get(rowIndex);\r\n            this.brick.events.fire('dom:row:focus', {\r\n                index: rowIndex,\r\n                row: data,\r\n                element: row\r\n            });\r\n        }*/\r\n    },\r\n\r\n    events: [\r\n            {\r\n                // Per-row render\r\n                for: 'table:render:row',\r\n                before:{\r\n                    fn: function(ev){\r\n                        const html = this.brick.html;\r\n                        const tr = ev.data.tr;\r\n                        html.off(tr,\"mousedown\");\r\n                    }\r\n                },\r\n                after:{\r\n                    fn: function(ev){\r\n                        const html = this.brick.html;\r\n                        const tr = ev.data.tr;\r\n                        html.on(tr,\"mousedown\",(e)=>{\r\n                           const root = this.brick.html.element(); // o la table/tbody si tens la ref\r\n                            root.querySelectorAll(\"tr.vb-focused\").forEach(el => {\r\n                                if (el !== tr) this.brick.css.removeClass(el, \"vb-focused\");\r\n                            });\r\n                            this.brick.css.addClass(tr, \"vb-focused\");\r\n                            this.brick.wire?.notify('dom:row:focus', {row:ev.data.row});\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n    ],\r\n\r\n    init: function () { },\r\n\r\n    destroy: function () { }\r\n};\r\n\r\nexport default tableRowsFocused;\r\n\r\n", "export const tableRows = {\n  for: [{ host: 'brick', kind: 'table' }],\n  requires: ['html', 'store', 'columns'],\n  ns: 'rows',\n  options: {},\n\n  brick: {\n    render: function () {\n      const html = this.brick.html;\n      const root = html.element();\n      if (!root) return;\n      const t0 = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\n\n      const rows = this.brick.store.load();\n      const columns = this.brick.columns.get();\n      // Fire render pipeline\n      this.brick.events.fireAsync('table:render:rows', { rows: rows, columns: columns }).then(() => {\n        const t1 = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();\n        const ms = Math.round(t1 - t0);\n        console.warn('table rows pipeline time', ms, 'ms');\n      });\n    }\n  },\n\n  extension: {},\n\n  events: [\n    {\n      for: 'brick:status:ready',\n      on: {\n        fn: function () {\n          this.brick.rows.render();\n        }\n      }\n    },\n    {\n      for: 'store:data:*',\n      after: {\n        fn: function (ev) {\n          this.brick.rows.render();\n        }\n      }\n    },\n    {\n      // Manage full rows render pipeline\n      for: 'table:render:rows',\n      before: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          const root = html.element && html.element();\n          if (!root) return;\n          ev.data = ev.data || {};\n\n          // Ensure rows/columns available to downstream phases\n          ev.data.rows = Array.isArray(ev.data.rows) ? ev.data.rows : this.brick.store.load();\n          ev.data.columns = Array.isArray(ev.data.columns) ? ev.data.columns : this.brick.columns.get();\n\n          const table = root.tagName && root.tagName.toLowerCase() === 'table'\n            ? root\n            : (html.get && html.get('table')) || (root.querySelector && root.querySelector('table'));\n          if (!table) return;\n\n          // Prepare old/new tbody and pool of existing trs\n          const oldTbody = html.detach(table.querySelector('tbody')); /*(table.tBodies && table.tBodies.length)\n            ? table.tBodies[0]\n            : table.querySelector && table.querySelector('tbody');*/\n          const newTbody = html.create('tbody');\n\n          ev.data.table = table;\n          ev.data.oldTbody = oldTbody;\n          ev.data.tbody = newTbody;\n          ev.data.frag = html.frag() || newTbody.ownerDocument.createDocumentFragment();\n        }\n      },\n      on: {\n        fn: function (ev) {\n          const data = ev.data || {};\n          const rows = Array.isArray(ev && ev.data && ev.data.rows) ? ev.data.rows : this.brick.store.load();\n          const columns = Array.isArray(ev && ev.data && ev.data.columns) ? ev.data.columns : this.brick.columns.get();\n          data.columns = columns;\n          data.rows = rows;\n          for (let i = 0; i < rows.length; i += 1) {\n            const rowData = rows[i] || {};\n            this.brick.events.fire('table:render:row', {\n              row: rowData,\n              rowIndex: i,\n              oldTbody: data.oldTbody,\n              frag: data.frag,\n              tbody: ev.data.tbody,\n              columns: columns\n            });\n          }\n        }\n      },\n      after: {\n        fn: function (ev) {\n          const data = ev.data || {};\n          const html = this.brick.html;\n          const tbody = data.tbody;\n          if (!tbody) return;\n\n          // Append assembled fragment\n          /*if (data.frag) {\n            html.append(tbody, data.frag);\n          }*/\n\n          html.append(data.table,tbody);\n          return;\n          // Replace old tbody with new\n          if (data.table) {\n            const table = data.table;\n            if (data.oldTbody && data.oldTbody.parentNode === table) {\n              table.replaceChild(tbody, data.oldTbody);\n            } else {\n              html.append(table, tbody);\n            }\n          }\n        }\n      }\n    },\n    {\n      // Per-row render\n      for: 'table:render:row',\n      before: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          let tr = null;\n          // Reuse from old tbody if available\n          const oldTbody = ev.data && ev.data.oldTbody;\n          if (oldTbody && oldTbody.firstChild) {\n            tr = oldTbody.firstChild;\n            oldTbody.removeChild(tr);\n          }\n          if (!tr) tr = html.create('tr');\n          \n          ev.data.tr = tr;\n        }\n      },\n      on: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          const tr = ev.data.tr;\n          const row = ev.data.row || {};\n          const columns = ev.data.columns || [];\n          html.attr(tr,\"key\", row.key);\n          for (let c = 0; c < columns.length; c += 1) {\n            const col = columns[c] || {};\n            this.brick.events.fire('table:render:col', {\n              tr: tr,\n              tdIndex: c,\n              column: col,\n              row: row,\n              rowIndex: ev.data.rowIndex\n            });\n          }\n        }\n      },\n      after: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          const tr = ev.data.tr;\n          const tbody = ev.data.tbody;\n          if (tbody && tr) {\n            html.append(tbody, tr);\n          }\n        }\n      }\n    },\n    {\n      // Per-column render\n      for: 'table:render:col',\n      before: {\n        fn: function (ev) {\n          const html = this.brick.html;\n          const tr = ev.data.tr;\n          const idx = ev.data.tdIndex;\n          if (!tr) return;\n          let td = (tr.cells && tr.cells[idx]) ? tr.cells[idx] : null;\n          if (!td) {\n            td = html.create('td');\n            // insert at correct position\n            if (tr.cells && idx < tr.cells.length) {\n              tr.insertBefore(td, tr.cells[idx]);\n            } else {\n              html.append(tr, td);\n            }\n          }\n          ev.data.td = td;\n        }\n      },\n      on: {\n        fn: function (ev) {\n          const td = ev.data.td;\n          const col = ev.data.column || {};\n          const row = ev.data.row || {};\n          const field = col.datafield;\n          const val = (field && Object.prototype.hasOwnProperty.call(row, field)) ? row[field] : '';\n          if (td) {\n            td.textContent = (val === undefined || val === null) ? '' : val;\n          }\n        }\n      },\n      after: {\n        fn: function () { }\n      }\n    }\n  ],\n\n  init: function () { },\n\n  destroy: function () { }\n};\n\nexport default tableRows;\n", "export const table = {\n  for: [{ host: 'brick', kind: 'table' }],\n  requires: ['html'],\n  ns: 'table',\n  options: {},\n\n  brick: {\n    refresh: function () {\n      if (this.__tableExt) this.__tableExt._refreshRows();\n    },\n    getSelection: function () {\n      const ext = this.__tableExt;\n      if (!ext) return { index: -1, row: null };\n      const idx = (typeof ext.selectedIndex === 'number') ? ext.selectedIndex : -1;\n      const row = (idx >= 0 && ext.rows && ext.rows[idx]) ? ext.rows[idx] : null;\n      return { index: idx, row: row };\n    },\n    clearSelection: function () {\n      if (this.__tableExt) this.__tableExt._setSelectedIndex(-1);\n    }\n  },\n\r\n  extension: {\r\n    table: null,\r\n    rows: [],\r\n    selectedIndex: -1,\r\n    _findTable: function () {\r\n      const root = this.brick.html && typeof this.brick.html.element === 'function'\n        ? this.brick.html.element()\n        : null;\n      if (!root || !root.querySelector) {\r\n        this.table = null;\r\n        return null;\r\n      }\r\n      const table =\n        root.querySelector('table.vb-table') ||\n        root.querySelector('table');\n      this.table = table || null;\n      return this.table;\n    },\n    _refreshRows: function () {\r\n      const table = this.table || this._findTable();\r\n      if (!table) {\r\n        this.rows = [];\r\n        this.selectedIndex = -1;\r\n        return;\r\n      }\r\n      const body = (table.tBodies && table.tBodies.length)\r\n        ? table.tBodies[0]\r\n        : table.querySelector('tbody');\r\n      const rows = body ? body.rows : table.rows;\r\n      this.rows = Array.prototype.slice.call(rows || []);\r\n      if (this.selectedIndex >= this.rows.length) {\r\n        this.selectedIndex = -1;\r\n      }\r\n    },\r\n    _setSelectedIndex: function (index) {\r\n      const rows = this.rows || [];\r\n      if (!rows.length) {\r\n        this.selectedIndex = -1;\r\n        return;\r\n      }\r\n      if (typeof index !== 'number' || index < 0 || index >= rows.length) {\r\n        index = -1;\r\n      }\r\n      for (let i = 0; i < rows.length; i += 1) {\n        const row = rows[i];\n        if (!row || !row.classList) continue;\n        if (i === index) row.classList.add('selected');\n        else row.classList.remove('selected');\n      }\n      this.selectedIndex = index;\n    }\n  },\n\r\n  events: [\r\n    {\r\n      for: 'brick:status:ready',\r\n      on: {\r\n        fn: function () {\r\n          this._findTable();\r\n          this._refreshRows();\r\n        }\r\n      }\r\n    },\r\n    {\r\n      for: 'dom:click:*',\r\n      on: {\r\n        fn: function (ev) {\r\n          const table = this.table || this._findTable();\r\n          if (!table) return;\r\n          if (!ev || !ev.data || !ev.data.domEvent) return;\r\n          const target = ev.data.domEvent.target;\r\n          if (!target) return;\r\n\r\n          let node = target;\r\n          let clickedRow = null;\r\n          while (node && node !== table) {\r\n            if (node.tagName && node.tagName.toLowerCase() === 'tr') {\r\n              clickedRow = node;\r\n              break;\r\n            }\r\n            node = node.parentNode;\r\n          }\r\n          if (!clickedRow) return;\r\n\r\n          this._refreshRows();\r\n          const rows = this.rows || [];\r\n          const index = rows.indexOf(clickedRow);\r\n          if (index === -1) return;\r\n          if (this.selectedIndex === index) this._setSelectedIndex(-1);\r\n          else this._setSelectedIndex(index);\r\n        }\r\n      }\r\n    }\r\n  ],\n\n  init: function () {\n    this.brick.__tableExt = this;\n    this.table = null;\n    this.rows = [];\n    this.selectedIndex = -1;\n    return true;\n  },\n\r\n  destroy: function () {\n    this.rows = [];\n    this.table = null;\n    this.selectedIndex = -1;\n    if (this.brick) {\n      delete this.brick.__tableExt;\n    }\n  }\n};\n\n\n\n\n\nexport default table;\n\r\n", "const WireService = {\r\n    kind: 'wire',\r\n};\r\n\r\nexport default WireService;\r\n", "/**\n * AUTO-GENERATED MANIFEST\n * Do not edit manually. This file is generated by scripts/build.mjs\n */\nimport extensions_0 from './extensions/html-css.js';\nimport extensions_1 from './extensions/html-events.js';\nimport extensions_2 from './extensions/html-render.js';\nimport extensions_3 from './extensions/html.js';\nimport extensions_4 from './extensions/store.js';\nimport extensions_5 from './extensions/wire-client.js';\nimport extensions_6 from './extensions/wire-service.js';\nimport components_0 from './components/form-items.js';\nimport components_1 from './components/form-record.js';\nimport components_2 from './components/form.js';\nimport components_3 from './components/status-bar.js';\nimport components_4 from './components/table-columns.js';\nimport components_5 from './components/table-rows-focused.js';\nimport components_6 from './components/table-rows.js';\nimport components_7 from './components/table.js';\nimport services_0 from './services/wire.js';\n\nexport function registerBuiltins(VanillaBrick) {\n\n// Automatic registration\nif (extensions_0) {\n  VanillaBrick.extensions['htmlCss'] = extensions_0;\n}\nif (extensions_1) {\n  VanillaBrick.extensions['htmlEvents'] = extensions_1;\n}\nif (extensions_2) {\n  VanillaBrick.extensions['htmlRender'] = extensions_2;\n}\nif (extensions_3) {\n  VanillaBrick.extensions['html'] = extensions_3;\n}\nif (extensions_4) {\n  VanillaBrick.extensions['store'] = extensions_4;\n}\nif (extensions_5) {\n  VanillaBrick.extensions['wire'] = extensions_5;\n}\nif (extensions_6) {\n  VanillaBrick.extensions['wireservice'] = extensions_6;\n}\nif (components_0) {\n  VanillaBrick.extensions['formItems'] = components_0;\n}\nif (components_1) {\n  VanillaBrick.extensions['formRecord'] = components_1;\n}\nif (components_2) {\n  VanillaBrick.extensions['form'] = components_2;\n}\nif (components_3) {\n  VanillaBrick.extensions['statusBar'] = components_3;\n}\nif (components_4) {\n  VanillaBrick.extensions['tableColumns'] = components_4;\n}\nif (components_5) {\n  VanillaBrick.extensions['tableRowsFocused'] = components_5;\n}\nif (components_6) {\n  VanillaBrick.extensions['tableRows'] = components_6;\n}\nif (components_7) {\n  VanillaBrick.extensions['table'] = components_7;\n}\nVanillaBrick.services['WireService'] = services_0;\n\n}\n", "import Brick from './brick/brick.js';\r\nimport ExtensionsRegistry from './controllers/extensionsRegistry.js';\r\nimport RuntimeController from './controllers/runtimeController.js';\r\nimport StatusController from './controllers/statusController.js';\r\nimport OptionsController from './controllers/optionsController.js';\r\nimport EventBusController from './controllers/eventsController.js';\r\nimport ExtensionsController from './controllers/extensionsController.js';\r\nimport * as optionsUtils from './utils/options.js';\r\n\r\n// Startup Logic\r\nimport { setupServices } from './startup/services.js';\r\nimport { setupBootstrap } from './startup/bootstrap.js';\r\n\r\n// Auto-generated manifest (at build time)\r\nimport { registerBuiltins } from './_manifest.js';\r\n\r\nconst runtimeCtrl = new RuntimeController();\r\n\r\nconst VanillaBrick = {\r\n    brick: Brick,\r\n    registry: ExtensionsRegistry,\r\n    utils: optionsUtils,\r\n    extensions: {},\r\n    services: {},\r\n    configs: {},\r\n    runtime: runtimeCtrl, // Global execution motor\r\n    base: {}\r\n};\r\n\r\n// Internal reference for tracking\r\nVanillaBrick.runtime.bricks = [];\r\nVanillaBrick.runtime.services = {};\r\nVanillaBrick.runtime.prototypes = {};\r\nVanillaBrick.runtime.controllers = {\r\n    status: new StatusController(),\r\n    options: new OptionsController(),\r\n    events: new EventBusController(),\r\n    extensions: new ExtensionsController()\r\n};\r\n\r\n// 1. Expose to global for extensions to find it if needed\r\nglobalThis.VanillaBrick = VanillaBrick;\r\n\r\n// 2. Register all extensions, components and services from manifest\r\nregisterBuiltins(VanillaBrick);\r\n\r\n// 3. Wire up core systems\r\nsetupServices(VanillaBrick);\r\nsetupBootstrap(VanillaBrick);\r\n\r\nexport default VanillaBrick;\r\nexport { Brick };\r\n"],
  "mappings": "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",
  "names": ["Brick", "options", "opts", "brick", "ctrl", "ExtensionsRegistry", "brick", "host", "kind", "cacheKey", "src", "candidates", "seenExtensions", "normalizeRule", "rule", "rHost", "rKind", "matchesRule", "currentHost", "currentKind", "hostMatch", "kindMatch", "key", "def", "rules", "match", "ri", "sortedList", "status", "visit", "name", "candidate", "k", "reqs", "i", "depName", "defs", "prototypes", "protoExt", "protoApi", "methodName", "methodFn", "extName", "extData", "args", "runtime", "meta", "extensionsRegistry_default", "RuntimeController", "fn", "context", "args", "meta", "brickId", "result", "err", "brickCtx", "errorInfo", "e", "StatusController", "brick", "self", "status", "payload", "newStatus", "state", "oldStatus", "__spreadValues", "options_exports", "__export", "getOption", "mergeOptions", "setOption", "result", "i", "source", "key", "sVal", "rVal", "obj", "path", "parts", "current", "value", "p", "OptionsController", "brick", "initialOptions", "self", "key", "fallback", "value", "data", "getOption", "state", "val", "result", "old", "setOption", "EventBusController", "brick", "self", "pattern", "phase", "priority", "handler", "meta", "eventName", "payload", "pr", "parts", "ns", "type", "target", "compiled", "key", "state", "handlersByPhase", "i", "h", "ph", "a", "b", "pa", "pb", "ev", "phaseHandlers", "runtime", "hnd", "r", "err", "phases", "p", "parseForPattern", "pattern", "bits", "ns", "action", "target", "ExtensionsController", "getRuntime", "brick", "registry", "extensionsRegistry_default", "defs", "runtime", "baked", "optionsCtrl", "mergeOptions", "userOptions", "kind", "coreDefaults", "extDefaults", "i", "def", "defOpts", "defName", "mergedOptions", "name", "extState", "protos", "ctxExt", "ext", "ctxApi", "k", "fn", "meta", "args", "res", "err", "nsObj", "apiName", "apiFn", "li", "evt", "parsed", "phase", "desc", "pr", "handler", "ev", "setupServices", "VanillaBrick", "name", "def", "opts", "brick", "service", "setupBootstrap", "VanillaBrick", "registry", "loadConfigs", "scope", "root", "scripts", "i", "raw", "parsed", "key", "base", "next", "err", "readKind", "el", "k", "createBrickFromElement", "opts", "config", "kind", "brick", "bootstrap", "nodes", "created", "id", "runOnce", "bootstrapped", "htmlCss", "el", "className", "cur", "force", "has", "prop", "value", "cs", "name", "html_css_default", "htmlEvents", "el", "type", "handler", "options", "listeners", "hasType", "hasHandler", "i", "ln", "self", "defaultMap", "entry", "domEvent", "html_events_default", "htmlRender", "el", "key", "value", "k", "selectorOrTag", "root", "tag", "props", "cfg", "target", "nodeOrFrag", "htmlString", "doc", "node", "walker", "attrs", "a", "name", "val", "fn", "items", "chunkSize", "renderChunk", "arr", "size", "render", "index", "resolve", "step", "slice", "html_render_default", "html", "type", "handler", "options", "el", "listeners", "i", "ln", "value", "err", "id", "elemOpt", "idOpt", "html_default", "DATA_SAMPLE_ROWS", "store", "data", "previous", "index", "arr", "value", "fallback", "rows", "field", "dir", "compareFn", "cmp", "a", "b", "va", "vb", "res", "ev", "storeData", "payload", "sorted", "store_default", "wire", "eventName", "data", "wire_client_default", "wireservice", "ev", "master", "evName", "evData", "slaves", "i", "data", "wire_service_default", "formItems", "root", "items", "groups", "i", "groupEl", "group", "fields", "j", "fieldEl", "input", "label", "fieldItem", "el", "current", "match", "html", "frag", "item", "rowEl", "field", "span", "colEl", "fieldContainer", "ev", "configVar", "form_items_default", "formRecord", "data", "record", "root", "inputs", "i", "input", "name", "ev", "form_record_default", "form", "el", "form_default", "statusBar", "ev", "record", "el", "status_bar_default", "tableColumns", "field", "dir", "colDef", "c", "state", "nextDir", "ev", "columns", "html", "root", "table", "thead", "row", "brick", "i", "col", "th", "existing", "table_columns_default", "tableRowsFocused", "ev", "html", "tr", "e", "_a", "el", "table_rows_focused_default", "tableRows", "t0", "rows", "columns", "t1", "ms", "ev", "html", "root", "table", "oldTbody", "newTbody", "data", "i", "rowData", "tbody", "tr", "row", "c", "col", "idx", "td", "field", "val", "table_rows_default", "table", "ext", "idx", "row", "root", "body", "rows", "index", "i", "ev", "target", "node", "clickedRow", "table_default", "WireService", "wire_default", "registerBuiltins", "VanillaBrick", "html_css_default", "html_events_default", "html_render_default", "html_default", "store_default", "wire_client_default", "wire_service_default", "form_items_default", "form_record_default", "form_default", "status_bar_default", "table_columns_default", "table_rows_focused_default", "table_rows_default", "table_default", "wire_default", "runtimeCtrl", "RuntimeController", "VanillaBrick", "Brick", "extensionsRegistry_default", "options_exports", "StatusController", "OptionsController", "EventBusController", "ExtensionsController", "registerBuiltins", "setupServices", "setupBootstrap", "src_default"]
}
