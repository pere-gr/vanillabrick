(()=>{var G=Object.defineProperty;var J=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var U=(e,t,n)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Q=(e,t)=>{for(var n in t||(t={}))te.call(t,n)&&U(e,n,t[n]);if(J)for(var n of J(t))ne.call(t,n)&&U(e,n,t[n]);return e};var oe=(e,t)=>{for(var n in t)G(e,n,{get:t[n],enumerable:!0})};function v(e){let t=e&&typeof e=="object"?Object.assign({},e):{};t.id=t.id||this._nextId(),t.host=(t.host||"brick").toLowerCase(),t.kind=(t.kind||"brick").toLowerCase(),Object.defineProperty(this,"id",{value:t.id,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"host",{value:t.host,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"kind",{value:t.kind,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"_runtime",{value:{},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(this,"_controllers",{value:globalThis.VanillaBrick.runtime.controllers,writable:!1,configurable:!1,enumerable:!1});let n=this,o=this._controllers;o.status&&o.status.init(n),o.options&&o.options.init(n,t),o.events&&o.events.init(n),o.extensions&&o.extensions.init(n),this.status={get:()=>o.status.get(n),set:(s,i)=>o.status.set(n,s,i),is:s=>o.status.is(n,s)},this.options={get:(s,i)=>o.options.get(n,s,i),set:(s,i)=>(o.options.setSync(n,s,i),n),setAsync:async(s,i)=>(await o.options.setAsync(n,s,i),n),has:s=>o.options.has(n,s),all:()=>o.options.all(n),setSilent:(s,i)=>(o.options.setSilent(n,s,i),n)},o.extensions&&o.extensions.applyAll(n),o.status&&o.status.set(n,"ready",{options:t})}v.prototype.destroy=function(){this._controllers.status.set(this,"destroyed"),this._runtime&&(this._runtime.status={},this._runtime.options={},this._runtime.events={},this._runtime.extensions={})};Object.defineProperty(v,"_idCounter",{value:0,writable:!0,configurable:!1,enumerable:!1});Object.defineProperty(v.prototype,"_nextId",{value:function(){return v._idCounter+=1,"brick-"+v._idCounter},writable:!1,configurable:!1,enumerable:!1});var se={_cache:{},all:function(e){if(!e||typeof e!="object")return console.warn("ExtensionsRegistry.all() called without brick context"),[];let t=(e.host||"brick").toLowerCase(),n=(e.kind||"").toLowerCase();if(!n)return[];let o=t+"::"+n;if(this._cache[o])return this._cache[o];let s=globalThis.VanillaBrick&&globalThis.VanillaBrick.extensions||{},i={},c=new Set;function r(a){if(!a||typeof a!="object")return null;let p=(a.host||"brick").toLowerCase(),m=typeof a.kind=="string"?a.kind.toLowerCase():"";return m?{host:p,kind:m}:null}function l(a,p,m){if(!a)return!1;let y=a.host==="*"||a.host===p,b=a.kind==="*"||a.kind===m;return y&&b}for(let a in s){if(!Object.prototype.hasOwnProperty.call(s,a))continue;let p=s[a];if(!p||typeof p!="object"||c.has(p))continue;p._name||(p._name=p.ns||a);let m=p.for;if(!Array.isArray(m)||!m.length){console.warn("VanillaBrick extension without valid `for` array, skipped",p._name||a);continue}let y=!1;for(let b=0;b<m.length;b+=1){let E=r(m[b]);if(E&&l(E,t,n)){y=!0;break}}y&&(i[a]={name:a,ext:p},c.add(p))}let f=[],u={};function d(a){if(u[a]==="ok")return!0;if(u[a]==="visiting"||u[a]==="missing")return!1;let p=i[a];if(!p){for(let y in i)if(i[y].ext.ns===a){p=i[y];break}}if(!p)return u[a]="missing",!1;u[a]="visiting";let m=p.ext.requires||p.ext._requires;if(Array.isArray(m))for(let y=0;y<m.length;y++){let b=m[y];if(!d(b))return u[a]="missing",!1}return u[a]="ok",f.push(p),!0}for(let a in i)d(a);return this._cache[o]=f,f},_bake:function(e){let t={};for(let n=0;n<e.length;n++){let o=e[n],s=o.name||o.ext.ns,i={_name:s,_def:o.ext};if(o.ext.extension&&typeof o.ext.extension=="object")for(let r in o.ext.extension)typeof o.ext.extension[r]=="function"&&(i[r]=o.ext.extension[r]);let c={};if(o.ext.brick)for(let r in o.ext.brick)typeof o.ext.brick[r]=="function"&&function(l,f,u){c[l]=function(){let d=this._extData&&this._extData[u];if(!d){console.warn(`VanillaBrick: Extension data not found for ${u} in namespace API call ${l}`);return}let a=Array.prototype.slice.call(arguments),p=globalThis.VanillaBrick?globalThis.VanillaBrick.runtime:null;if(p&&typeof p.execute=="function"){let m={type:"brick-api",ext:u,brick:d.ctx.brick?d.ctx.brick.id:"unknown",fnName:l};return p.execute(f,d.ctx,a,m)}return f.apply(d.ctx,a)}}(r,o.ext.brick[r],s);t[s]={ext:i,api:c}}return t}},O=se;function C(){}C.prototype.execute=function(e,t,n,o){"use strict";if(typeof e!="function"){let s=o&&o.brick||t&&t.brick&&t.brick.id||"unknown";console.warn(`[RuntimeController] Attempted to execute non-function for brick ${s}`,o);return}try{let s=e.apply(t,n);return s&&typeof s.then=="function"?s.catch(function(i){return this._handleError(i,e,t,o),Promise.reject(i)}.bind(this)):s}catch(s){throw this._handleError(s,e,t,o),s}};C.prototype._handleError=function(e,t,n,o){var s=n&&n.brick?n.brick:n;(!s||!s.id)&&o&&o.brick&&(s={id:o.brick});let i={error:e,message:e.message||String(e),stack:e.stack,meta:o||{},context:{brick:s&&s.id?s.id:null,kind:s&&s.kind?s.kind:null}};try{i.fnSource=t.toString()}catch(c){i.fnSource="[unable to capture source]"}console.error("[RuntimeController] Error executing developer code:",i)};function _(){}_.prototype.init=function(e){!e||!e._runtime||(e._runtime.status={value:"initializing",listening:!0})};_.prototype.get=function(e){return e&&e._runtime&&e._runtime.status?e._runtime.status.value:void 0};_.prototype.is=function(e,t){return!e||!e._runtime||!e._runtime.status?!1:e._runtime.status.value===t};_.prototype.set=function(e,t,n){if(!e||!e._runtime||!e._runtime.status)return;let o=e._runtime.status;if(!o.listening||o.value===t)return;let s=o.value;o.value=t,e.events&&(e.events.fire("brick:status:change",Q({from:s,to:t},n)),e.events.fire("brick:status:"+t,n)),t==="destroyed"&&(o.listening=!1)};var L={};oe(L,{getOption:()=>S,mergeOptions:()=>w,setOption:()=>A});function w(){let e={};for(let t=0;t<arguments.length;t++){let n=arguments[t];if(!(!n||typeof n!="object"))for(let o in n){if(!Object.prototype.hasOwnProperty.call(n,o))continue;let s=n[o],i=e[o];s&&typeof s=="object"&&!Array.isArray(s)&&i&&typeof i=="object"&&!Array.isArray(i)?e[o]=w(i,s):e[o]=s}}return e}function S(e,t){if(!e||!t)return;if(!t.indexOf("."))return e[t];let n=t.split("."),o=e;for(let s=0;s<n.length;s++){if(o==null)return;o=o[n[s]]}return o}function A(e,t,n){if(!e||!t)return;let o=t.split("."),s=e;for(let i=0;i<o.length-1;i++){let c=o[i];(s[c]===void 0||s[c]===null)&&(s[c]={}),s=s[c]}s[o[o.length-1]]=n}function g(){}g.prototype.init=function(e,t){!e||!e._runtime||(e._runtime.options={data:t||{},cache:{}})};g.prototype.all=function(e){return e&&e._runtime&&e._runtime.options?e._runtime.options.data:{}};g.prototype.has=function(e,t){let n=e&&e._runtime&&e._runtime.options?e._runtime.options.data:{};return S(n,t)!==void 0};g.prototype.get=function(e,t,n){let o=e&&e._runtime?e._runtime.options:null;if(!o)return n;if(o.cache&&Object.prototype.hasOwnProperty.call(o.cache,t))return o.cache[t];let s=S(o.data,t),i=s===void 0?n:s;return o.cache&&(o.cache[t]=i),i};g.prototype.setSync=function(e,t,n){let o=e&&e._runtime?e._runtime.options:null;if(!o)return;let s=this.get(e,t);s!==n&&(A(o.data,t,n),o.cache={},e.events&&(e.events.fire("brick:option:changed",{key:t,value:n,oldValue:s}),e.events.fire("brick:option:changed:"+t,{value:n,oldValue:s})))};g.prototype.setSilent=function(e,t,n){let o=e&&e._runtime?e._runtime.options:null;o&&(A(o.data,t,n),o.cache={})};g.prototype.setAsync=async function(e,t,n){return this.setSync(e,t,n),Promise.resolve()};function h(){this.phases=["before","on","after"]}h.prototype.init=function(e){if(!e||!e._runtime)return;e._runtime.events={handlers:[],dispatchCache:{}};let t=this;e.events={on:function(n,o,s,i,c){return t.on(e,n,o,s,i,c),e},off:function(n,o,s){return t.off(e,n,o,s),e},fire:function(n,o){return t.fire(e,n,o),e},fireAsync:function(n,o){return t.fireAsync(e,n,o)}}};h.prototype._normalizePriority=function(e){let t=typeof e=="number"?e:5;return t<0&&(t=0),t>10&&(t=10),t};h.prototype._compilePattern=function(e){let t=(e||"").split(":"),n=t[0],o=t[1],s=t[2];return{namespace:!n||n==="*"?void 0:n,type:!o||o==="*"?void 0:o,target:!s||s==="*"?void 0:s}};h.prototype._parseEventKey=function(e){let t=(e||"").split(":");return{namespace:t[0]||"",type:t[1]||"",target:t[2]||""}};h.prototype._matches=function(e,t){return(e.namespace===void 0||e.namespace===t.namespace)&&(e.type===void 0||e.type===t.type)&&(e.target===void 0||e.target===t.target)};h.prototype._validateEventName=function(e){if(typeof e!="string")return console.error("[EventBus] Event name must be a string.",e),!1;let t=e.split(":");return t.length!==3?(console.error('[EventBus] Invalid event name format. Expected exactly "namespace:type:target" (3 segments). Got:',e),!1):!t[0]||t[0]==="*"||!t[1]||t[1]==="*"||!t[2]||t[2]==="*"?(console.error("[EventBus] Invalid event name for dispatch. Wildcards (*) and empty segments are not allowed in namespace, type, or target.",e),!1):!0};h.prototype._getHandlersForEvent=function(e,t,n){if(!e||!e._runtime||!e._runtime.events)return n?[]:{before:[],on:[],after:[]};let o=e._runtime.events,s;if(o.dispatchCache[t])s=o.dispatchCache[t];else{let i=this._parseEventKey(t);s={before:[],on:[],after:[]};for(let c=0;c<o.handlers.length;c+=1){let r=o.handlers[c];this._matches(r.compiled,i)&&s[r.phase]&&s[r.phase].push(r)}o.dispatchCache[t]=s}return n?s[n]||[]:s};h.prototype.on=function(e,t,n,o,s,i){if(typeof n=="function"?(i=s,s=n,n="on",o=void 0):typeof o=="function"&&typeof s!="function"&&(i=s,s=o,o=void 0),!s)return;let c=n||"on";this.phases.indexOf(c)===-1&&(c="on");let r=this._normalizePriority(o),l=e._runtime.events;l.handlers.push({pattern:t,compiled:this._compilePattern(t),phase:c,handler:s,priority:r,meta:i||null}),l.handlers.sort(function(f,u){let d=typeof f.priority=="number"?f.priority:5,a=typeof u.priority=="number"?u.priority:5;return d-a}),l.dispatchCache={}};h.prototype.off=function(e,t,n,o){if(!e||!e._runtime||!e._runtime.events)return;let s=e._runtime.events;for(let i=s.handlers.length-1;i>=0;i-=1){let c=s.handlers[i];t&&c.pattern!==t||n&&c.phase!==n||o&&c.handler!==o||s.handlers.splice(i,1)}s.dispatchCache={}};h.prototype._firePhase=async function(e,t,n,o){o.event.phase=t,o.stopPhase=!1;let s=this._getHandlersForEvent(e,n,t),i=globalThis.VanillaBrick?globalThis.VanillaBrick.runtime:null;for(let c=0;c<s.length&&!o.stopPhase;c+=1){let r=s[c],l=r.handler;try{let f;l&&typeof l=="object"&&typeof l.fn=="function"?i?f=i.execute(l.fn,l.ctx,[o],l.meta):f=l.fn.apply(l.ctx,[o]):typeof l=="function"&&(i?f=i.execute(l,{brick:e},[o],r.meta):f=l(o,{brick:e})),f&&typeof f.then=="function"&&await f}catch(f){console.error("Error in event handler execution:",f,{h:r,eventName:n,phase:t}),o.errors.push({error:f,phase:t,event:n}),o.cancel=!0}}return o};h.prototype._run=async function(e,t,n){if(!e||!e._runtime||!e._runtime.events)return{event:{name:t},errors:[{error:"Event system not initialized for this brick"}],cancel:!0};if(!this._validateEventName(t))return{event:{name:t},errors:[{error:"Invalid event name format or wildcards in dispatch"}],cancel:!0};let o=this._parseEventKey(t),s={brick:e||null,cancel:!1,data:n,errors:[],event:{phase:null,name:t,namespace:o.namespace,type:o.type,target:o.target},stopPhase:!1},i=this.phases;for(let c=0;c<i.length;c+=1){let r=i[c];r==="on"&&s.cancel||await this._firePhase(e,r,t,s)}return s};h.prototype.fire=function(e,t,n){this._run(e,t,n)};h.prototype.fireAsync=function(e,t,n){return this._run(e,t,n)};function ie(e){if(!e)return{ns:"",action:"",target:"*"};let t=String(e).split(":"),n=t[0]||"",o=t[1]||"",s=t.length>2?t.slice(2).join(":"):"*";return s||(s="*"),{ns:n,action:o,target:s}}function k(){}function q(){return globalThis.VanillaBrick&&globalThis.VanillaBrick.runtime?globalThis.VanillaBrick.runtime:null}k.prototype.init=function(e){!e||!e._runtime||(e._runtime.extensions={map:{},destroyHook:!1})};k.prototype.applyAll=function(e){let t=O;if(!t||typeof t.all!="function")return;let n=t.all(e)||[];if(n.length==0)return;let o=q();if(o){o.prototypes||(o.prototypes={});let i=t._bake(n);Object.assign(o.prototypes,i)}let s=e._controllers&&e._controllers.options;if(!w||typeof w!="function")console.error("mergeOptions is missing; cannot merge extension defaults safely");else if(s&&typeof s.get=="function"){let i=e._runtime&&e._runtime.options?e._runtime.options.data:{},c=(e.kind||"").toLowerCase(),r=[],l=[];for(let u=0;u<n.length;u+=1){let d=n[u],a=d.ext.options||d.ext._options;if(!a)continue;let p=(d.ext.ns||d.name||"").toLowerCase();p&&c&&p===c+"-core"?r.push(a):l.push(a)}let f=w.apply(null,r.concat(l,[i]));e._runtime&&e._runtime.options&&(e._runtime.options.data=f,e._runtime.options.cache={})}for(let i=0;i<n.length;i+=1)this._install(e,n[i]);this._ensureDestroyHook(e)};k.prototype._install=function(e,t){let n=t.name||t.ext.ns||null,o=t.ext.ns||n;if(!n){console.warn("VanillaBrick extension without name/ns, skipped",t);return}let s=e&&e._runtime?e._runtime.extensions:null;if(!s||s.map[n])return;let i=q(),c=i&&i.prototypes?i.prototypes[n]:null,r;if(c&&c.ext)r=Object.create(c.ext),r.brick=e,r.ext=r,r._ctx=r;else{let f={name:n,def:t.ext,brick:e};r=Object.create(f),r.brick=e,r.ext=f,r._ctx=r}Object.defineProperty(r,"options",{value:e.options,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(r,"events",{value:e.events,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(r,"status",{value:e.status,writable:!1,enumerable:!1,configurable:!0});let l=r;if(!c&&t.ext.extension&&typeof t.ext.extension=="object")for(let f in t.ext.extension){if(!Object.prototype.hasOwnProperty.call(t.ext.extension,f))continue;let u=t.ext.extension[f];if(typeof u=="function"){let d={type:"extension-private",ext:n,brick:e.id,fnName:f};r[f]=function(){let a=Array.prototype.slice.call(arguments);return i&&typeof i.execute=="function"?i.execute(u,r,a,d):u.apply(r,a)}}}if(typeof t.ext.init=="function")try{let f;if(i&&typeof i.execute=="function"?f=i.execute(t.ext.init,r,[],{type:"init",ext:n,brick:e.id,fnName:"init"}):f=t.ext.init.call(r),f===!1)return}catch(f){console.error('VanillaBrick extension "'+n+'" init() failed',f);return}if(t.ext.brick&&typeof t.ext.brick=="object"){e[o]||(e[o]={_extData:{}});let f=e[o];if(f._extData||(f._extData={}),c&&c.api)Object.assign(f,c.api),f._extData[n]={ctx:l,fns:t.ext.brick,meta:{}};else for(let u in t.ext.brick){if(!Object.prototype.hasOwnProperty.call(t.ext.brick,u))continue;let d=t.ext.brick[u];if(typeof d!="function")continue;let a={type:"brick-api",ext:n,brick:e.id,fnName:o+"."+u};f[u]=function(){let p=Array.prototype.slice.call(arguments);return i&&typeof i.execute=="function"?i.execute(d,l,p,a):d.apply(l,p)}}}if(Array.isArray(t.ext.events)&&t.ext.events.length&&e.events&&typeof e.events.on=="function")for(let f=0;f<t.ext.events.length;f+=1){let u=t.ext.events[f];if(!u)continue;let d=ie(u.for),a=d.ns+":"+d.action+":"+d.target;["before","on","after"].forEach(function(p){let m=u[p];if(!m||typeof m.fn!="function")return;let y=typeof m.priority=="number"?m.priority:void 0,b={type:"event",ext:n,brick:e.id,event:a,phase:p,fnName:m.fn.name||"anon"},E=function(ee){let $=[ee];return i&&typeof i.execute=="function"?i.execute(m.fn,r,$,b):m.fn.apply(r,$)};e.events.on(a,p,y,E,{ext:n,fn:m.fn.name})})}s.map[n]=r};k.prototype._ensureDestroyHook=function(e){let t=e&&e._runtime?e._runtime.extensions:null;t&&(t.destroyHook||!e||!e.events||typeof e.events.on!="function"||(t.destroyHook=!0,e.events.on("brick:status:destroyed","on",0,function(){let n=q();for(let o in t.map){if(!Object.prototype.hasOwnProperty.call(t.map,o))continue;let s=t.map[o],i=s._def?{destroy:s._def.destroy,ns:s._name}:s.def||{};if(typeof i.destroy=="function")try{n&&typeof n.execute=="function"?n.execute(i.destroy,s,[],{type:"destroy",ext:o,brick:e.id,fnName:"destroy"}):i.destroy.call(s)}catch(c){console.error('VanillaBrick extension "'+o+'" destroy() failed',c)}}t.map={}})))};function X(e){e.runtime.services=e.runtime.services||{},e.service=function(t){return e.runtime.services[t]?e.runtime.services[t]:e.base.serviceStart(t)},e.base.serviceStart=function(t){if(e.runtime.services[t])return e.runtime.services[t];let n=e.services[t];if(!n)return console.warn("Service definition not found:",t),null;let o=Object.assign({},n);o.id=t,o.host="service",o.kind=o.kind||"service";let s=new e.brick(o);return e.runtime.services[t]=s,e.runtime.bricks&&Array.isArray(e.runtime.bricks)&&e.runtime.bricks.push(s),s},e.base.serviceStop=function(t){let n=e.runtime.services[t];n&&(n.destroy&&n.destroy(),delete e.runtime.services[t])}}function Y(e){e.base=e.base||{},e.configs=e.configs||{};let t={list:[],byId:{}};function n(r){if(typeof document=="undefined")return;let l=r||document;if(!l.querySelectorAll)return;let f=l.querySelectorAll('script[type="application/json"][data-brick]');for(let u=0;u<f.length;u+=1){let a=f[u].textContent||"";if(a.trim())try{let p=JSON.parse(a);if(!p||typeof p!="object")continue;for(let m in p){if(!Object.prototype.hasOwnProperty.call(p,m))continue;let y=e.configs[m]&&typeof e.configs[m]=="object"?e.configs[m]:{},b=p[m];!b||typeof b!="object"||(e.configs[m]=Object.assign({},y,b))}}catch(p){console.warn("VanillaBrick: invalid JSON in data-brick config",p)}}}function o(r){if(!r)return;let l=r.getAttribute("brick-kind")||r.getAttribute("data-kind")||r.getAttribute("data-brick-kind")||r.dataset&&(r.dataset.kind||r.dataset.brickKind);return l?String(l).toLowerCase():void 0}function s(r){if(!r)return null;if(r.__brickInstance)return r.__brickInstance;let l={},f=r.id&&e.configs?e.configs[r.id]:null;f&&typeof f=="object"&&Object.assign(l,f),r.id&&(l.id=r.id);let u=o(r);u&&(l.kind=u),l.dom={id:r.id||null,element:r};let d=new e.brick(l);return r.__brickInstance=d,t.list.push(d),t.byId[d.id]=d,console.log("Brick",r.id,d),d}function i(r){if(typeof document=="undefined")return[];let l=r||document;if(!l.querySelectorAll)return[];n(l);let f=l.querySelectorAll(".vb"),u=[];for(let d=0;d<f.length;d++){let a=s(f[d]);a&&u.push(a)}return u}if(e.base.bootstrap=i,e.runtime=e.runtime||{},e.runtime.bricks=t.list||[],e.base.getBrick=function(r){return t.byId[r]||null},typeof document!="undefined"){let r=function(){c||(c=!0,i())};var c=!1;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){r()}):setTimeout(r,0)}}var re={for:[{host:"brick",kind:"*"}],requires:["dom"],ns:"css",options:{},brick:{addClass:function(e){let t=this.dom.element();if(!(!t||!e))if(t.classList&&t.classList.add)t.classList.add(e);else{let n=t.className||"";(" "+n+" ").indexOf(" "+e+" ")===-1&&(t.className=(n?n+" ":"")+e)}},removeClass:function(e){let t=this.dom.element();if(!(!t||!e))if(t.classList&&t.classList.remove)t.classList.remove(e);else{let n=t.className||"";t.className=(" "+n+" ").replace(" "+e+" "," ").trim()}},hasClass:function(e){let t=this.dom.element();return!t||!e?!1:t.classList&&t.classList.contains?t.classList.contains(e):(" "+(t.className||"")+" ").indexOf(" "+e+" ")!==-1},toggleClass:function(e,t){let n=this.dom.element();if(!(!n||!e))if(n.classList&&typeof n.classList.toggle=="function")typeof t=="boolean"?n.classList.toggle(e,t):n.classList.toggle(e);else{let o=this.css.hasClass(e);typeof t=="boolean"?(t&&!o&&this.css.addClass(e),!t&&o&&this.css.removeClass(e)):o?this.css.removeClass(e):this.css.addClass(e)}},show:function(){let e=this.dom.element();e&&(e.style.display="")},hide:function(){let e=this.dom.element();e&&(e.style.display="none")},setStyle:function(e,t){let n=this.dom.element();!n||!e||(n.style[e]=t)},getStyle:function(e){let t=this.dom.element();if(!t||!e||typeof window=="undefined"||!window.getComputedStyle)return null;let n=window.getComputedStyle(t);return n?n.getPropertyValue(e)||n[e]:null},setVar:function(e,t){let n=this.dom.element();!n||!e||(e.indexOf("--")!==0&&(e="--"+e),n.style.setProperty(e,t))},getVar:function(e){let t=this.dom.element();if(!t||!e||typeof window=="undefined"||!window.getComputedStyle)return null;e.indexOf("--")!==0&&(e="--"+e);let n=window.getComputedStyle(t);return n?n.getPropertyValue(e):null}},extension:{},events:[],init:function(){return!this.brick||!this.brick.dom||typeof this.brick.dom.element!="function"?(console.warn("VanillaBrick domCss requires dom extension active",this.brick&&this.brick.id),!1):this.brick.dom.element()?!0:(console.warn("VanillaBrick domCss: no DOM element resolved",this.brick&&this.brick.id),!1)},destroy:function(){}},j=re;var ce={for:[{host:"brick",kind:"*"}],requires:["dom"],ns:"dom",options:{},brick:{},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){let e=this.brick.dom.element();if(!e||typeof e.addEventListener!="function")return;let t=this.brick.options.get("dom.events.listeners",[]);Array.isArray(t)||(t=[]);let n=this,o=[{type:"click",eventName:"dom:mouse:click"},{type:"mouseenter",eventName:"dom:hover:on"},{type:"mouseleave",eventName:"dom:hover:off"},{type:"mousedown",eventName:"dom:mouse:down"},{type:"mouseup",eventName:"dom:mouse:up"}];for(let s=0;s<o.length;s+=1){let i=o[s],c=function(l){n.brick.events.fire(i.eventName,{domEvent:l,element:e})};e.addEventListener(i.type,c),t.push({type:i.type,handler:c,source:"default"})}this.brick.options.setSilent("dom.events.listeners",t)}}},{for:"brick:status:destroyed",before:{fn:function(){let e=this.brick&&this.brick.dom.element&&this.brick.dom.element();if(!e||typeof e.removeEventListener!="function")return;let t=this.brick.options.get("dom.events.listeners",[]);if(Array.isArray(t)){for(let n=0;n<t.length;n+=1){let o=t[n];e.removeEventListener(o.type,o.handler,o.options)}this.brick.options.setSilent("dom.events.listeners",[])}}}}],init:function(){},destroy:function(){}},I=ce;var fe={for:[{host:"brick",kind:"*"}],requires:[],ns:"dom",options:{},brick:{element:function(){return this.options.get("dom.element",null)},on:function(e,t,n){let o=this.options.get("dom.element",null);if(!o||typeof o.addEventListener!="function"||typeof t!="function")return;o.addEventListener(e,t,n);let s=this.options.get("dom.listeners",[]);Array.isArray(s)||(s=[]),s.push({type:e,handler:t,options:n,source:"api"}),this.options.setSilent("dom.listeners",s)},off:function(e,t,n){let o=this.options.get("dom.element",null);if(!o||typeof o.removeEventListener!="function"||typeof t!="function")return;o.removeEventListener(e,t,n);let s=this.options.get("dom.listeners",[]);if(Array.isArray(s)){for(let i=s.length-1;i>=0;i-=1){let c=s[i];c.type===e&&c.handler===t&&s.splice(i,1)}this.options.setSilent("dom.listeners",s)}}},extension:{_resolveElement:function(e){if(!e)return null;if(typeof Element!="undefined"&&e instanceof Element||e&&e.nodeType===1)return e;if(typeof e=="function")try{return e()}catch(t){return null}return null},_resolveById:function(e){return!e||typeof e!="string"||typeof document=="undefined"?null:document.getElementById(e)||null}},events:[],init:function(){if(!this.brick)return!1;let e=this.brick.options.get("dom.element",null),t=this.brick.options.get("dom.id",null),n=this._resolveElement(e);return!n&&t&&(n=this._resolveById(t)),n?(e&&!this._resolveElement(e)&&console.warn("VanillaBrick dom element must be a DOM node or factory, not an id. Use options.dom.id to resolve by id.",this.brick.id),this.brick.options.set("dom.element",n),!0):(console.warn("VanillaBrick dom extension requires a DOM element (options.dom.element) or a valid options.dom.id",this.brick.id),!1)},destroy:function(){let e=this.brick.options.get("dom.element",null),t=this.brick.options.get("dom.listeners",null);if(e&&Array.isArray(t))for(let n=0;n<t.length;n+=1){let o=t[n];o&&o.type&&o.handler&&e.removeEventListener(o.type,o.handler,o.options)}}},P=fe;var le=[{code:"1",name:"one",key:1},{code:"2",name:"two",key:2},{code:"3",name:"three",key:3},{code:"4",name:"four",key:4},{code:"5",name:"five",key:5},{code:"6",name:"six",key:6},{code:"7",name:"seven",key:7},{code:"8",name:"eight",key:8},{code:"9",name:"nine",key:9},{code:"10",name:"ten",key:10},{code:"11",name:"eleven",key:11},{code:"12",name:"twelve",key:12},{code:"13",name:"thirteen",key:13},{code:"14",name:"fourteen",key:14},{code:"15",name:"fifteen",key:15},{code:"16",name:"sixteen",key:16},{code:"17",name:"seventeen",key:17},{code:"18",name:"eighteen",key:18},{code:"19",name:"nineteen",key:19},{code:"20",name:"twenty",key:20}],ue={for:[{host:"brick",kind:"form"},{host:"brick",kind:"grid"}],requires:[],ns:"store",options:{},brick:{load:function(){return this.brick.options.get("store.data",[])},set:function(e){if(e===null)return;let t=this.brick.options.get("store.data",[]);return e=Array.isArray(e)?e.slice():[e],this.brick.events.fire("store:data:set",{previous:t,data:e}),e},setAsync:async function(e){let t=this.brick.options.get("store.data",[]);return e=Array.isArray(e)?e.slice():[],await this.brick.events.fireAsync("store:data:set",{previous:t,data:e}),e},all:function(){return this.brick.store.load()},get:function(e){let t=this.brick.store.load();return typeof e!="number"||e<0||e>=t.length?null:t[e]}},extension:{_normalizeArray:function(e,t){return Array.isArray(e)?e.slice():Array.isArray(t)?t.slice():[]},_sortRows:function(e,t,n,o){let s=Array.isArray(e)?e.slice():[],i=typeof o=="function"?function(c,r){return o(c,r,n)}:function(c,r){let l=c&&Object.prototype.hasOwnProperty.call(c,t)?c[t]:void 0,f=r&&Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0,u=0;return l===f?u=0:l==null?u=-1:f==null?u=1:typeof l=="number"&&typeof f=="number"?u=l-f:u=String(l).localeCompare(String(f)),n==="desc"?-u:u};return s.sort(i),s}},events:[{for:"brick:status:ready",on:{fn:function(e){let t=this._normalizeArray(le,[]);this.brick.options.setSilent("store.data",t)}}},{for:"store:data:set",on:{fn:function(e){let t=e&&e.data||null,n=t&&t.data?t.data:[];this.brick.options.setSilent("store.data",n)}}},{for:"store:data:sort",on:{fn:function(e){let t=e&&e.data||{},n=t.field||null,o=t.dir||"asc";if(!n||!this.brick)return;let s=this._sortRows(this.brick.store.load(),n,o,t.compare);this.brick.options.setSilent("store.data",s),e.field=n,e.dir=o,e.data=s}}}],init:function(){},destroy:function(){}},T=ue;var ae={for:[{host:"brick",kind:"*"}],requires:[],ns:"wire",options:{},brick:{notify:function(e,t){console.warn("WireClient > sending notify",e,t),console.log("	for event",e),console.log("	with payload",t),this.ext._service||this.ext._connect(),this.ext._service&&this.ext._service.events.fire("wire:notify:out",{from:this.brick.id,event:e,data:t})},request:function(e,t){console.warn("request",e,t),console.log("this",this),this.ext._service||this.ext._connect(),this.ext._service&&(console.log("this.service",this.ext._service),this.ext._service.events.fire("wire:request:out",{from:this.brick.id,event:e,data:t}))}},extension:{_service:null,_connect:function(){this.ext._service||this.brick.options.get("wire",null)==null||(globalThis.VanillaBrick&&globalThis.VanillaBrick.service&&(this.ext._service=globalThis.VanillaBrick.service("WireService")),this.ext._service?this.ext._service.events.fire("wire:register:in",{brick:this.brick,options:this.brick.options.get("wire",{})}):console.warn("[Wire Client] No Wire Service found.",this.ext._service))}},events:[{for:"brick:status:ready",on:{fn:function(){this._connect()}}}],init:function(){},destroy:function(){}},R=ae;var de={for:[{host:"service",kind:"wire"}],requires:[],ns:"wire",options:{},brick:{},events:[{for:"wire:notify:out",on:{fn:function(e){console.warn("WireService > on wire:notify:out",e);let t=e.data.from;console.log("	from",t);let n=e.data.event;console.log("	evName",n);let o=e.data.data;console.log("	evData",o);let s=this.ext._slaves[t];if(console.log("	for slaves",s),s&&s.length>0)for(let i=0;i<s.length;i++)console.log("	- firing",n,"in",s[i].brick.id),s[i].brick.events.fire(n,o)}}},{for:"wire:register:in",on:{fn:function(e){this.ext._register(e.data)}}}],extension:{_register:function(e){if(console.warn("register",e.brick,e.options,this),e.options.master&&(this.ext._bricks==null&&(this.ext._bricks={}),this.ext._bricks[e.brick.id]=e.brick),e.options.slaveOf&&e.options.slaveOf.length>0){this.ext._masters==null&&(this.ext._masters={}),this.ext._slaves==null&&(this.ext._slaves={});for(let t=0;t<e.options.slaveOf.length;t++)this.ext._masters[e.brick.id]||(this.ext._masters[e.brick.id]=[]),this.ext._masters[e.brick.id].push({id:e.options.slaveOf[t].id,kind:e.options.slaveOf[t].kind}),this.ext._slaves[e.options.slaveOf[t].id]||(this.ext._slaves[e.options.slaveOf[t].id]=[]),this.ext._slaves[e.options.slaveOf[t].id].push({id:e.brick.id,kind:e.brick.kind,brick:e.brick})}console.log("_bricks",this.ext._bricks),console.log("_masters",this.ext._masters),console.log("_slaves",this.ext._slaves)}}},D=de;var pe={for:[{host:"brick",kind:"form"}],requires:["dom"],ns:"items",options:{},brick:{get:function(){return this.options.get("form.items",[])}},extension:{_parseFromDom:function(){let e=this.brick.dom.element();if(!e)return[];let t=[],n=e.querySelectorAll(".vb-form-group");for(let o=0;o<n.length;o++){let s=n[o],i={type:"group",items:[]},c=s.querySelectorAll(".vb-form-field");for(let r=0;r<c.length;r++){let l=c[r],f=l.querySelector("input, select, textarea"),u=l.querySelector("label");if(f){let d={type:"field",name:f.name||f.id,label:u?u.textContent:"",controlType:f.tagName.toLowerCase(),inputType:f.type,required:f.required,placeholder:f.placeholder,span:this._detectSpan(l)};i.items.push(d)}}t.push(i)}return t},_detectSpan:function(e){let t=e;for(;t&&!t.classList.contains("vb-row");){if(t.className&&typeof t.className=="string"){let n=t.className.match(/vb-span-(\d+)/);if(n)return parseInt(n[1],10)}if(t=t.parentElement,!t||t.tagName==="FORM")break}return 12},_render:function(e){let t=this.brick.dom.element();if(t){t.innerHTML="";for(let n=0;n<e.length;n++){let o=e[n];if(o.type!=="group")continue;let s=document.createElement("div");s.className="vb-form-group";let i=document.createElement("div");if(i.className="vb-row",o.items&&o.items.length)for(let c=0;c<o.items.length;c++){let r=o.items[c],l=r.span||12,f=document.createElement("div");f.className="vb-span-"+l;let u=document.createElement("div");if(u.className="vb-form-field",r.label){let a=document.createElement("label");a.textContent=r.label,r.name&&(a.htmlFor=r.name),u.appendChild(a)}let d;r.controlType==="textarea"?d=document.createElement("textarea"):r.controlType==="select"?d=document.createElement("select"):(d=document.createElement("input"),d.type=r.inputType||"text"),r.name&&(d.name=r.name,d.id=r.name),r.placeholder&&(d.placeholder=r.placeholder),(r.required===!0||r.required==="true"||r.required==="required")&&(d.required=!0),u.appendChild(d),f.appendChild(u),i.appendChild(f)}s.appendChild(i),t.appendChild(s)}}}},events:[{for:"brick:status:ready",before:{fn:function(e){let t=[];if(this.brick.options.has("form.items")&&(t=this.brick.options.get("form.items")),!t||t.length===0){let n=this.brick.dom.element();if(n){let o=n.getAttribute("brick-form-items")||n.getAttribute("data-form-items");o&&window[o]&&(console.log("[Form Items] Config var found",o),t=window[o],this.brick.options.set("form.items",t))}(!t||t.length===0)&&(console.log("[Form Items] Parsing from DOM",this.brick.id),t=this._parseFromDom(),this.brick.options.set("form.items",t))}else console.log("[Form Items] Config found in options",t);e.data=e.data||{},e.data.formItems=t}},on:{fn:function(e){let t=e.data.formItems||this.brick.options.get("form.items");t&&t.length>0&&this._render(t)}}}],init:function(){return!0},destroy:function(){}},F=pe;var me={for:[{host:"brick",kind:"form"}],requires:["dom","store"],ns:"record",options:{},brick:{getRecord:function(){let e=this.store.load();return e&&e.length?e[0]:null}},extension:{_bind:function(e){let t=this.brick.dom.element();if(!t)return;let n=t.querySelectorAll("input, select, textarea");for(let o=0;o<n.length;o++){let s=n[o],i=s.name||s.id;i&&(e&&Object.prototype.hasOwnProperty.call(e,i)?s.value=e[i]:e||(s.value=""))}}},events:[{for:"brick:status:ready",on:{fn:function(e){let t=this.brick.store.load();t&&t.length&&this._bind(t[0])}}},{for:"store:data:*",after:{fn:function(e){let t=this.brick.store.load(),n=t&&t.length?t[0]:null;this._bind(n)}}},{for:"dom:row:focus",after:{fn:function(e){console.warn("Form > master focused a row",e);let t=e.data.row;console.log("	record",t),this._bind(t)}}}],init:function(){return!0},destroy:function(){}},H=me;var he={for:[{host:"brick",kind:"form"}],requires:["dom"],ns:"form",options:{items:[]},brick:{submit:function(){let e=this.dom.element();e&&typeof e.submit=="function"&&e.submit()},reset:function(){let e=this.dom.element();e&&typeof e.reset=="function"&&e.reset()}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){}}}],init:function(){return!0},destroy:function(){}},M=he;var ye={for:[{host:"brick",kind:"grid"}],requires:["dom","store"],ns:"columns",brick:{get:function(){return this.options.get("grid.columns",[])},sort:function(e,t){let o=this.brick.columns.get().find(function(c){return c&&c.datafield===e})||{},s=this.options.get("grid.sort",{field:null,dir:null}),i=t;return i!=="asc"&&i!=="desc"&&(i=s.field===e&&s.dir==="asc"?"desc":"asc"),this.events.fire("store:data:sort",{field:e,dir:i,compare:typeof o.sort=="function"?o.sort:null}),i}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){let e=this.brick.columns.get(),t=this.brick.dom.element&&this.brick.dom.element();if(!t)return;let n=t.tagName&&t.tagName.toLowerCase()==="table"?t:t.querySelector&&t.querySelector("table");if(!n)return;let o=n.tHead?n.tHead:n.querySelector("thead");o||(o=n.createTHead?n.createTHead():n.insertBefore(document.createElement("thead"),n.firstChild));let s=o.rows&&o.rows[0]?o.rows[0]:o.insertRow();s.innerHTML="";let i=this.brick;for(let c=0;c<e.length;c+=1){let r=e[c]||{},l=document.createElement("th");l.textContent=r.label||r.datafield||"",r.sortable&&r.datafield&&(l.classList.add("vb-sortable"),l.addEventListener("click",function(f){return function(){i.columns.sort(f.datafield,null)}}(r))),s.appendChild(l)}}}},{for:"store:data:sort",after:{fn:function(e){this.brick.options.setSilent("grid.sort",{field:e.field,dir:e.dir||"asc"})}}}],init:function(){},destroy:function(){},options:{grid:{columns:[{datafield:"code",label:"Code",sortable:!0},{datafield:"name",label:"Name",sortable:!0}]}}},W=ye;var be={for:[{host:"brick",kind:"grid"}],requires:["dom","rows","store"],ns:"rowsFocused",options:{},brick:{},extension:{_addTabIndex:function(){let e=this.brick.dom.element();if(!e)return;let t=e.querySelectorAll("tbody tr")||[];for(let n=0;n<t.length;n++){let o=t[n];o.hasAttribute("tabindex")||o.setAttribute("tabindex",n)}},_handleFocus:function(e){let t=this.brick.dom.element();if(!t)return;let n=e.closest("tr");if(!n)return;let o=t.querySelector("tr.vb-focused");o&&o.classList.remove("vb-focused"),n.classList.add("vb-focused");let s=Array.prototype.indexOf.call(n.parentNode.children,n),i=this.brick.store.get(s);this.brick.events.fire("dom:row:focus",{index:s,row:i,element:n})}},events:[{for:"brick:status:ready",on:{fn:function(){let e=this.brick.dom.element();if(e){let t=this;e.addEventListener("focusin",function(n){t._handleFocus(n.target)})}this._addTabIndex()}}},{for:"store:data:set",after:{fn:function(e){this._addTabIndex()}}},{for:"store:data:sort",after:{fn:function(){this._addTabIndex()}}},{for:"dom:row:focus",after:{fn:function(e){var t;(t=this.brick.wire)==null||t.notify("dom:row:focus",e.data)}}}],init:function(){},destroy:function(){}},K=be;var ge={for:[{host:"brick",kind:"grid"}],requires:["dom","store","columns"],ns:"rows",options:{},brick:{render:function(){let e=this.brick.dom.element();if(!e)return;let t=e.tagName&&e.tagName.toLowerCase()==="table"?e:e.querySelector&&e.querySelector("table");if(!t)return;let n=this.brick.columns.get(),o=this.brick.store.load(),s=t.tBodies&&t.tBodies.length?t.tBodies[0]:t.querySelector("tbody");s||(s=document.createElement("tbody"),t.appendChild(s)),s.innerHTML="";for(let i=0;i<o.length;i+=1){let c=o[i]||{},r=document.createElement("tr");for(let l=0;l<n.length;l+=1){let u=(n[l]||{}).datafield,d=document.createElement("td");d.textContent=u&&c[u]!==void 0&&c[u]!==null?c[u]:"",r.appendChild(d)}s.appendChild(r)}}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){this.brick.rows.render()}}},{for:"store:data:*",after:{fn:function(e){this.brick.rows.render()}}}],init:function(){},destroy:function(){}},N=ge;var xe={for:[{host:"brick",kind:"grid"}],requires:["dom"],ns:"grid",options:{},brick:{refresh:function(){this.__gridExt&&this.__gridExt._refreshRows()},getSelection:function(){let e=this.__gridExt;if(!e)return{index:-1,row:null};let t=typeof e.selectedIndex=="number"?e.selectedIndex:-1,n=t>=0&&e.rows&&e.rows[t]?e.rows[t]:null;return{index:t,row:n}},clearSelection:function(){this.__gridExt&&this.__gridExt._setSelectedIndex(-1)}},extension:{table:null,rows:[],selectedIndex:-1,_findTable:function(){let e=this.brick.dom&&typeof this.brick.dom.element=="function"?this.brick.dom.element():null;if(!e||!e.querySelector)return this.table=null,null;let t=e.querySelector("table.vb-grid")||e.querySelector("table");return this.table=t||null,this.table},_refreshRows:function(){let e=this.table||this._findTable();if(!e){this.rows=[],this.selectedIndex=-1;return}let t=e.tBodies&&e.tBodies.length?e.tBodies[0]:e.querySelector("tbody"),n=t?t.rows:e.rows;this.rows=Array.prototype.slice.call(n||[]),this.selectedIndex>=this.rows.length&&(this.selectedIndex=-1)},_setSelectedIndex:function(e){let t=this.rows||[];if(!t.length){this.selectedIndex=-1;return}(typeof e!="number"||e<0||e>=t.length)&&(e=-1);for(let n=0;n<t.length;n+=1){let o=t[n];!o||!o.classList||(n===e?o.classList.add("vb-grid-row-selected"):o.classList.remove("vb-grid-row-selected"))}this.selectedIndex=e}},events:[{for:"brick:status:ready",on:{fn:function(){this._findTable(),this._refreshRows()}}},{for:"dom:click:*",on:{fn:function(e){let t=this.table||this._findTable();if(!t||!e||!e.data||!e.data.domEvent)return;let n=e.data.domEvent.target;if(!n)return;let o=n,s=null;for(;o&&o!==t;){if(o.tagName&&o.tagName.toLowerCase()==="tr"){s=o;break}o=o.parentNode}if(!s)return;this._refreshRows();let c=(this.rows||[]).indexOf(s);c!==-1&&(this.selectedIndex===c?this._setSelectedIndex(-1):this._setSelectedIndex(c))}}}],init:function(){return this.brick.__gridExt=this,this.table=null,this.rows=[],this.selectedIndex=-1,!0},destroy:function(){this.rows=[],this.table=null,this.selectedIndex=-1,this.brick&&delete this.brick.__gridExt}},z=xe;var ve={for:[{host:"brick",kind:"status-bar"}],requires:["dom"],ns:"statusBar",events:[{for:"dom:row:focus",after:{fn:function(e){let t=e.data.row,n=this.brick.dom.element();n&&(n.textContent=`Wire OK -> Selected: ${t.name}`)}}}],init:function(){let e=this.brick.dom.element();e&&(e.textContent="Wire status: Waiting for grid...")}},B=ve;var _e={kind:"wire"},Z=_e;function V(e){j&&(e.extensions.domCss=j),I&&(e.extensions.domEvents=I),P&&(e.extensions.dom=P),T&&(e.extensions.store=T),R&&(e.extensions.wire=R),D&&(e.extensions.wireservice=D),F&&(e.extensions.formItems=F),H&&(e.extensions.formRecord=H),M&&(e.extensions.form=M),W&&(e.extensions.gridColumns=W),K&&(e.extensions.gridRowsFocused=K),N&&(e.extensions.gridRows=N),z&&(e.extensions.grid=z),B&&(e.extensions.statusBar=B),e.services.WireService=Z}var ke=new C,x={brick:v,registry:O,utils:L,extensions:{},services:{},configs:{},runtime:ke,base:{}};x.runtime.bricks=[];x.runtime.services={};x.runtime.prototypes={};x.runtime.controllers={status:new _,options:new g,events:new h,extensions:new k};globalThis.VanillaBrick=x;V(x);X(x);Y(x);var Et=x;})();
//# sourceMappingURL=vanillabrick.min.js.map
